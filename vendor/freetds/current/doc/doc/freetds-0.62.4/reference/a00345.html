<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tds.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>tds.h</h1><a href="a00273.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* FreeTDS - Library of routines accessing Sybase and Microsoft databases</span>
00002 <span class="comment"> * Copyright (C) 1998-1999  Brian Bruns</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
00005 <span class="comment"> * modify it under the terms of the GNU Library General Public</span>
00006 <span class="comment"> * License as published by the Free Software Foundation; either</span>
00007 <span class="comment"> * version 2 of the License, or (at your option) any later version.</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00012 <span class="comment"> * Library General Public License for more details.</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> * You should have received a copy of the GNU Library General Public</span>
00015 <span class="comment"> * License along with this library; if not, write to the</span>
00016 <span class="comment"> * Free Software Foundation, Inc., 59 Temple Place - Suite 330,</span>
00017 <span class="comment"> * Boston, MA 02111-1307, USA.</span>
00018 <span class="comment"> */</span>
00019 
00020 <span class="preprocessor">#ifndef _tds_h_</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#define _tds_h_</span>
00022 <span class="preprocessor"></span>
00023 <span class="keyword">static</span> <span class="keywordtype">char</span> rcsid_tds_h[] = <span class="stringliteral">"$Id: tds.h,v 1.167 2003/12/31 11:33:10 freddy77 Exp $"</span>;
00024 <span class="keyword">static</span> <span class="keywordtype">void</span> *no_unused_tds_h_warn[] = { rcsid_tds_h, no_unused_tds_h_warn };
00025 
00026 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00027 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
00028 <span class="preprocessor">#include &lt;time.h&gt;</span>
00029 
00030 <span class="comment">/* forward declaration */</span>
00031 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsiconvinfo TDSICONVINFO;
00032 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_socket TDSSOCKET;
00033 
00034 <span class="preprocessor">#include "tdsver.h"</span>
00035 <span class="preprocessor">#include "tds_sysdep_public.h"</span>
00036 <span class="preprocessor">#ifdef _FREETDS_LIBRARY_SOURCE</span>
00037 <span class="preprocessor"></span><span class="preprocessor">#include "tds_sysdep_private.h"</span>
00038 <span class="preprocessor">#endif </span><span class="comment">/* _FREETDS_LIBRARY_SOURCE */</span>
00039 
00040 <span class="preprocessor">#ifdef __cplusplus</span>
00041 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span>
00042 {
00043 <span class="preprocessor">#if 0</span>
00044 <span class="preprocessor"></span>}
00045 <span class="preprocessor">#endif</span>
00046 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00047 <span class="preprocessor"></span>
<a name="l00053"></a><a class="code" href="a00129.html">00053</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00129.html">_tds_compiletime_settings</a>
00054 {
00055         <span class="keyword">const</span> <span class="keywordtype">char</span> *freetds_version;    <span class="comment">/* release version of FreeTDS */</span>
00056         <span class="keyword">const</span> <span class="keywordtype">char</span> *last_update;        <span class="comment">/* latest software_version date among the modules */</span>
00057         <span class="keywordtype">int</span> msdblib;            <span class="comment">/* for MS style dblib */</span>
00058         <span class="keywordtype">int</span> sybase_compat;      <span class="comment">/* enable increased Open Client binary compatibility */</span>
00059         <span class="keywordtype">int</span> threadsafe;         <span class="comment">/* compile for thread safety default=no */</span>
00060         <span class="keywordtype">int</span> libiconv;           <span class="comment">/* search for libiconv in DIR/include and DIR/lib */</span>
00061         <span class="keyword">const</span> <span class="keywordtype">char</span> *tdsver;     <span class="comment">/* TDS protocol version (4.2/4.6/5.0/7.0/8.0) 5.0 */</span>
00062         <span class="keywordtype">int</span> iodbc;              <span class="comment">/* build odbc driver against iODBC in DIR */</span>
00063         <span class="keywordtype">int</span> unixodbc;           <span class="comment">/* build odbc driver against unixODBC in DIR */</span>
00064 
00065 } <a class="code" href="a00129.html">TDS_COMPILETIME_SETTINGS</a>;
00066 
00067 <span class="keyword">struct </span>DSTR_STRUCT {
00068         <span class="comment">/* keep always at last */</span>
00069         <span class="keywordtype">char</span> dstr_s[1];
00070 };
00071 <span class="keyword">typedef</span> <span class="keyword">struct </span>DSTR_STRUCT *DSTR;
00072 
00088 <span class="comment">/* </span>
00089 <span class="comment"> * All references to data that touch the wire should use the following typedefs.  </span>
00090 <span class="comment"> *</span>
00091 <span class="comment"> * If you have problems on 64-bit machines and the code is </span>
00092 <span class="comment"> * using a native datatype, please change it to use</span>
00093 <span class="comment"> * these. (In the TDS layer only, the API layers have their</span>
00094 <span class="comment"> * own typedefs which equate to these).</span>
00095 <span class="comment"> */</span>
00096 <span class="keyword">typedef</span> <span class="keywordtype">char</span> TDS_CHAR;                                  <span class="comment">/*  8-bit char     */</span>
00097 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> TDS_UCHAR;                        <span class="comment">/*  8-bit uchar    */</span>
00098 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> TDS_TINYINT;                      <span class="comment">/*  8-bit unsigned */</span>
00099 <span class="keyword">typedef</span> tds_sysdep_int16_type TDS_SMALLINT;             <span class="comment">/* 16-bit int      */</span>
00100 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> tds_sysdep_int16_type TDS_USMALLINT;   <span class="comment">/* 16-bit unsigned */</span>
00101 <span class="keyword">typedef</span> tds_sysdep_int32_type TDS_INT;                  <span class="comment">/* 32-bit int      */</span>
00102 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> tds_sysdep_int32_type TDS_UINT;        <span class="comment">/* 32-bit unsigned */</span>
00103 <span class="keyword">typedef</span> tds_sysdep_real32_type TDS_REAL;                <span class="comment">/* 32-bit real     */</span>
00104 <span class="keyword">typedef</span> tds_sysdep_real64_type TDS_FLOAT;               <span class="comment">/* 64-bit real     */</span>
00105 <span class="keyword">typedef</span> tds_sysdep_int64_type TDS_INT8;                 <span class="comment">/* 64-bit integer  */</span>
00106 <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> tds_sysdep_int64_type TDS_UINT8;       <span class="comment">/* 64-bit unsigned */</span>
00107 <span class="keyword">typedef</span> tds_sysdep_intptr_type TDS_INTPTR;
00108 
00109 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsnumeric
00110 {
00111         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> precision;
00112         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> scale;
00113         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> array[33];
00114 } TDS_NUMERIC;
00115 
00116 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsoldmoney
00117 {
00118         TDS_INT mnyhigh;
00119         TDS_UINT mnylow;
00120 } TDS_OLD_MONEY;
00121 
00122 <span class="keyword">typedef</span> <span class="keyword">union </span>tdsmoney
00123 {
00124         TDS_OLD_MONEY tdsoldmoney;
00125         TDS_INT8 mny;
00126 } TDS_MONEY;
00127 
00128 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsmoney4
00129 {
00130         TDS_INT mny4;
00131 } TDS_MONEY4;
00132 
00133 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsdatetime
00134 {
00135         TDS_INT dtdays;
00136         TDS_INT dttime;
00137 } TDS_DATETIME;
00138 
00139 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsdatetime4
00140 {
00141         TDS_USMALLINT days;
00142         TDS_USMALLINT minutes;
00143 } TDS_DATETIME4;
00144 
00145 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsvarbinary
00146 {
00147         TDS_INT len;
00148         TDS_CHAR array[256];
00149 } TDS_VARBINARY;
00150 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsvarchar
00151 {
00152         TDS_INT len;
00153         TDS_CHAR array[256];
00154 } TDS_VARCHAR;
00155 
00156 <span class="keyword">typedef</span> <span class="keyword">struct </span>tdsunique
00157 {
00158         TDS_UINT Data1;
00159         TDS_USMALLINT Data2;
00160         TDS_USMALLINT Data3;
00161         TDS_UCHAR Data4[8];
00162 } TDS_UNIQUE;
00163 
<a name="l00165"></a><a class="code" href="a00185.html">00165</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00185.html">tdsdaterec</a>
00166 {
<a name="l00167"></a><a class="code" href="a00185.html#m0">00167</a>         TDS_INT <a class="code" href="a00185.html#m0">year</a>;          
<a name="l00168"></a><a class="code" href="a00185.html#m1">00168</a>         TDS_INT <a class="code" href="a00185.html#m1">month</a>;         
<a name="l00169"></a><a class="code" href="a00185.html#m2">00169</a>         TDS_INT <a class="code" href="a00185.html#m2">day</a>;           
<a name="l00170"></a><a class="code" href="a00185.html#m3">00170</a>         TDS_INT <a class="code" href="a00185.html#m3">dayofyear</a>;     
<a name="l00171"></a><a class="code" href="a00185.html#m4">00171</a>         TDS_INT <a class="code" href="a00185.html#m4">weekday</a>;       
<a name="l00172"></a><a class="code" href="a00185.html#m5">00172</a>         TDS_INT <a class="code" href="a00185.html#m5">hour</a>;          
<a name="l00173"></a><a class="code" href="a00185.html#m6">00173</a>         TDS_INT <a class="code" href="a00185.html#m6">minute</a>;        
<a name="l00174"></a><a class="code" href="a00185.html#m7">00174</a>         TDS_INT <a class="code" href="a00185.html#m7">second</a>;        
<a name="l00175"></a><a class="code" href="a00185.html#m8">00175</a>         TDS_INT <a class="code" href="a00185.html#m8">millisecond</a>;   
00176         TDS_INT tzone;
00177 } <a class="code" href="a00185.html">TDSDATEREC</a>;
00178 
<a name="l00184"></a><a class="code" href="a00273.html#a259">00184</a> <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">int</span> tds_numeric_bytes_per_prec[];
00185 
00186 <span class="preprocessor">#define TDS_SUCCEED          1</span>
00187 <span class="preprocessor"></span><span class="preprocessor">#define TDS_FAIL             0</span>
00188 <span class="preprocessor"></span><span class="preprocessor">#define TDS_NO_MORE_RESULTS  2</span>
00189 <span class="preprocessor"></span>
00190 <span class="preprocessor">#define TDS_REG_ROW          -1</span>
00191 <span class="preprocessor"></span><span class="preprocessor">#define TDS_NO_MORE_ROWS     -2</span>
00192 <span class="preprocessor"></span><span class="preprocessor">#define TDS_COMP_ROW         -3</span>
00193 <span class="preprocessor"></span><span class="preprocessor">#define TDS_END_ROW          -4</span>
00194 <span class="preprocessor"></span>
00195 <span class="preprocessor">#define TDS_INT_EXIT 0</span>
00196 <span class="preprocessor"></span><span class="preprocessor">#define TDS_INT_CONTINUE 1</span>
00197 <span class="preprocessor"></span><span class="preprocessor">#define TDS_INT_CANCEL 2</span>
00198 <span class="preprocessor"></span><span class="preprocessor">#define TDS_INT_TIMEOUT 3</span>
00199 <span class="preprocessor"></span>
00200 
00201 <span class="preprocessor">#define TDS_NO_COUNT         -1</span>
00202 <span class="preprocessor"></span>
00203 <span class="preprocessor">#define TDS_ROW_RESULT        4040</span>
00204 <span class="preprocessor"></span><span class="preprocessor">#define TDS_PARAM_RESULT      4042</span>
00205 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STATUS_RESULT     4043</span>
00206 <span class="preprocessor"></span><span class="preprocessor">#define TDS_MSG_RESULT        4044</span>
00207 <span class="preprocessor"></span><span class="preprocessor">#define TDS_COMPUTE_RESULT    4045</span>
00208 <span class="preprocessor"></span><span class="preprocessor">#define TDS_CMD_DONE          4046</span>
00209 <span class="preprocessor"></span><span class="preprocessor">#define TDS_CMD_SUCCEED       4047</span>
00210 <span class="preprocessor"></span><span class="preprocessor">#define TDS_CMD_FAIL          4048</span>
00211 <span class="preprocessor"></span><span class="preprocessor">#define TDS_ROWFMT_RESULT     4049</span>
00212 <span class="preprocessor"></span><span class="preprocessor">#define TDS_COMPUTEFMT_RESULT 4050</span>
00213 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DESCRIBE_RESULT   4051</span>
00214 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DONE_RESULT       4052</span>
00215 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DONEPROC_RESULT   4053</span>
00216 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DONEINPROC_RESULT 4054</span>
00217 <span class="preprocessor"></span>
00218 <span class="keyword">enum</span> tds_end
00219 {
00220         TDS_DONE_FINAL = 0x00   <span class="comment">/* final result set, command completed successfully. */</span>
00221                 , TDS_DONE_MORE_RESULTS = 0x01  <span class="comment">/* more results follow */</span>
00222                 , TDS_DONE_ERROR = 0x02 <span class="comment">/* error occurred */</span>
00223                 , TDS_DONE_INXACT = 0x04        <span class="comment">/* transaction in progress */</span>
00224                 , TDS_DONE_PROC = 0x08  <span class="comment">/* results are from a stored procedure */</span>
00225                 , TDS_DONE_COUNT = 0x10 <span class="comment">/* count field in packet is valid */</span>
00226                 , TDS_DONE_CANCELLED = 0x20     <span class="comment">/* acknowledging an attention command (usually a cancel) */</span>
00227                 , TDS_DONE_EVENT = 0x40 <span class="comment">/* part of an event notification. */</span>
00228                 <span class="comment">/* after the above flags, a TDS_DONE packet has a field describing the state of the transaction */</span>
00229                 , TDS_DONE_NO_TRAN = 0  <span class="comment">/* No transaction in effect */</span>
00230                 , TDS_DONE_TRAN_SUCCEED = 1     <span class="comment">/* Transaction completed successfully */</span>
00231                 , TDS_DONE_TRAN_PROGRESS = 2    <span class="comment">/* Transaction in progress */</span>
00232                 , TDS_DONE_STMT_ABORT = 3       <span class="comment">/* A statement aborted */</span>
00233                 , TDS_DONE_TRAN_ABORT = 4       <span class="comment">/* Transaction aborted */</span>
00234 };
00235 
00236 <span class="comment">/*</span>
00237 <span class="comment"> * TDS_ERROR indicates a successful processing, but that a TDS_ERROR_TOKEN or TDS_EED_TOKEN error was encountered.  </span>
00238 <span class="comment"> * TDS_FAIL indicates an unrecoverable failure.</span>
00239 <span class="comment"> */</span>
00240 <span class="preprocessor">#define TDS_ERROR            3</span>
00241 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DONT_RETURN      42</span>
00242 <span class="preprocessor"></span>
00243 <span class="preprocessor">#define TDS5_PARAMFMT2_TOKEN       32   </span><span class="comment">/* 0x20 */</span>
00244 <span class="preprocessor">#define TDS_LANGUAGE_TOKEN         33   </span><span class="comment">/* 0x21    TDS 5.0 only              */</span>
00245 <span class="preprocessor">#define TDS_ORDERBY2_TOKEN         34   </span><span class="comment">/* 0x22 */</span>
00246 <span class="preprocessor">#define TDS_ROWFMT2_TOKEN          97   </span><span class="comment">/* 0x61    TDS 5.0 only              */</span>
00247 <span class="preprocessor">#define TDS_LOGOUT_TOKEN          113   </span><span class="comment">/* 0x71    TDS 5.0 only? ct_close()  */</span>
00248 <span class="preprocessor">#define TDS_RETURNSTATUS_TOKEN    121   </span><span class="comment">/* 0x79                              */</span>
00249 <span class="preprocessor">#define TDS_PROCID_TOKEN          124   </span><span class="comment">/* 0x7C    TDS 4.2 only - TDS_PROCID */</span>
00250 <span class="preprocessor">#define TDS7_RESULT_TOKEN         129   </span><span class="comment">/* 0x81    TDS 7.0 only              */</span>
00251 <span class="preprocessor">#define TDS7_COMPUTE_RESULT_TOKEN 136   </span><span class="comment">/* 0x88    TDS 7.0 only              */</span>
00252 <span class="preprocessor">#define TDS_COLNAME_TOKEN         160   </span><span class="comment">/* 0xA0    TDS 4.2 only              */</span>
00253 <span class="preprocessor">#define TDS_COLFMT_TOKEN          161   </span><span class="comment">/* 0xA1    TDS 4.2 only - TDS_COLFMT */</span>
00254 <span class="preprocessor">#define TDS_DYNAMIC2_TOKEN        163   </span><span class="comment">/* 0xA3 */</span>
00255 <span class="preprocessor">#define TDS_TABNAME_TOKEN         164   </span><span class="comment">/* 0xA4 */</span>
00256 <span class="preprocessor">#define TDS_COLINFO_TOKEN         165   </span><span class="comment">/* 0xA5 */</span>
00257 <span class="preprocessor">#define TDS_OPTIONCMD_TOKEN       166   </span><span class="comment">/* 0xA6 */</span>
00258 <span class="preprocessor">#define TDS_COMPUTE_NAMES_TOKEN   167   </span><span class="comment">/* 0xA7 */</span>
00259 <span class="preprocessor">#define TDS_COMPUTE_RESULT_TOKEN  168   </span><span class="comment">/* 0xA8 */</span>
00260 <span class="preprocessor">#define TDS_ORDERBY_TOKEN         169   </span><span class="comment">/* 0xA9    TDS_ORDER                 */</span>
00261 <span class="preprocessor">#define TDS_ERROR_TOKEN           170   </span><span class="comment">/* 0xAA                              */</span>
00262 <span class="preprocessor">#define TDS_INFO_TOKEN            171   </span><span class="comment">/* 0xAB                              */</span>
00263 <span class="preprocessor">#define TDS_PARAM_TOKEN           172   </span><span class="comment">/* 0xAC    RETURNVALUE?              */</span>
00264 <span class="preprocessor">#define TDS_LOGINACK_TOKEN        173   </span><span class="comment">/* 0xAD                              */</span>
00265 <span class="preprocessor">#define TDS_CONTROL_TOKEN         174   </span><span class="comment">/* 0xAE    TDS_CONTROL               */</span>
00266 <span class="preprocessor">#define TDS_ROW_TOKEN             209   </span><span class="comment">/* 0xD1                              */</span>
00267 <span class="preprocessor">#define TDS_CMP_ROW_TOKEN         211   </span><span class="comment">/* 0xD3                              */</span>
00268 <span class="preprocessor">#define TDS5_PARAMS_TOKEN         215   </span><span class="comment">/* 0xD7    TDS 5.0 only              */</span>
00269 <span class="preprocessor">#define TDS_CAPABILITY_TOKEN      226   </span><span class="comment">/* 0xE2                              */</span>
00270 <span class="preprocessor">#define TDS_ENVCHANGE_TOKEN       227   </span><span class="comment">/* 0xE3                              */</span>
00271 <span class="preprocessor">#define TDS_EED_TOKEN             229   </span><span class="comment">/* 0xE5                              */</span>
00272 <span class="preprocessor">#define TDS_DBRPC_TOKEN           230   </span><span class="comment">/* 0xE6                              */</span>
00273 <span class="preprocessor">#define TDS5_DYNAMIC_TOKEN        231   </span><span class="comment">/* 0xE7    TDS 5.0 only              */</span>
00274 <span class="preprocessor">#define TDS5_PARAMFMT_TOKEN       236   </span><span class="comment">/* 0xEC    TDS 5.0 only              */</span>
00275 <span class="preprocessor">#define TDS_AUTH_TOKEN            237   </span><span class="comment">/* 0xED                              */</span>
00276 <span class="preprocessor">#define TDS_RESULT_TOKEN          238   </span><span class="comment">/* 0xEE                              */</span>
00277 <span class="preprocessor">#define TDS_DONE_TOKEN            253   </span><span class="comment">/* 0xFD    TDS_DONE                  */</span>
00278 <span class="preprocessor">#define TDS_DONEPROC_TOKEN        254   </span><span class="comment">/* 0xFE    TDS_DONEPROC              */</span>
00279 <span class="preprocessor">#define TDS_DONEINPROC_TOKEN      255   </span><span class="comment">/* 0xFF    TDS_DONEINPROC            */</span>
00280 
00281 <span class="comment">/* CURSOR support: TDS 5.0 only*/</span>
00282 <span class="preprocessor">#define TDS_CURCLOSE_TOKEN        128  </span><span class="comment">/* 0x80    TDS 5.0 only              */</span>
00283 <span class="preprocessor">#define TDS_CURFETCH_TOKEN        130  </span><span class="comment">/* 0x82    TDS 5.0 only              */</span>
00284 <span class="preprocessor">#define TDS_CURINFO_TOKEN         131  </span><span class="comment">/* 0x83    TDS 5.0 only              */</span>
00285 <span class="preprocessor">#define TDS_CUROPEN_TOKEN         132  </span><span class="comment">/* 0x84    TDS 5.0 only              */</span>
00286 <span class="preprocessor">#define TDS_CURDECLARE_TOKEN      134  </span><span class="comment">/* 0x86    TDS 5.0 only              */</span>
00287 
00288 <span class="comment">/* </span>
00289 <span class="comment"> * Cursor Declare, SetRows, Open and Close all return 0x83 token. </span>
00290 <span class="comment"> * But only SetRows includes the rowcount (4 byte) in the stream. </span>
00291 <span class="comment"> * So for Setrows we read the rowcount from the stream and not for others. </span>
00292 <span class="comment"> * These values are useful to determine when to read the rowcount from the packet</span>
00293 <span class="comment"> */</span>
00294 <span class="preprocessor">#define IS_DECLARE  100</span>
00295 <span class="preprocessor"></span><span class="preprocessor">#define IS_CURROW   200</span>
00296 <span class="preprocessor"></span><span class="preprocessor">#define IS_OPEN     300</span>
00297 <span class="preprocessor"></span><span class="preprocessor">#define IS_CLOSE    400</span>
00298 <span class="preprocessor"></span>
00299 <span class="comment">/* states for tds_process_messages() */</span>
00300 <span class="preprocessor">#define PROCESS_ROWS    0</span>
00301 <span class="preprocessor"></span><span class="preprocessor">#define PROCESS_RESULTS 1</span>
00302 <span class="preprocessor"></span><span class="preprocessor">#define CANCEL_PROCESS  2</span>
00303 <span class="preprocessor"></span><span class="preprocessor">#define GOTO_1ST_ROW    3</span>
00304 <span class="preprocessor"></span><span class="preprocessor">#define LOGIN           4</span>
00305 <span class="preprocessor"></span>
00306 <span class="comment">/* environment type field */</span>
00307 <span class="preprocessor">#define TDS_ENV_DATABASE        1</span>
00308 <span class="preprocessor"></span><span class="preprocessor">#define TDS_ENV_LANG            2</span>
00309 <span class="preprocessor"></span><span class="preprocessor">#define TDS_ENV_CHARSET         3</span>
00310 <span class="preprocessor"></span><span class="preprocessor">#define TDS_ENV_PACKSIZE        4</span>
00311 <span class="preprocessor"></span><span class="preprocessor">#define TDS_ENV_LCID            5</span>
00312 <span class="preprocessor"></span><span class="preprocessor">#define TDS_ENV_SQLCOLLATION    7</span>
00313 <span class="preprocessor"></span>
00314 <span class="comment">/* string types */</span>
00315 <span class="preprocessor">#define TDS_NULLTERM -9</span>
00316 <span class="preprocessor"></span>
00317 <span class="comment">/* Microsoft internal stored procedure id's */</span>
00318 
00319 <span class="preprocessor">#define TDS_SP_CURSOR           1</span>
00320 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSOROPEN       2</span>
00321 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSORPREPARE    3</span>
00322 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSOREXECUTE    4</span>
00323 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSORPREPEXEC   5</span>
00324 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSORUNPREPARE  6</span>
00325 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSORFETCH      7</span>
00326 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSOROPTION     8</span>
00327 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_CURSORCLOSE      9</span>
00328 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_EXECUTESQL      10</span>
00329 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_PREPARE         11</span>
00330 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_EXECUTE         12</span>
00331 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_PREPEXEC        13</span>
00332 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_PREPEXECRPC     14</span>
00333 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SP_UNPREPARE       15</span>
00334 <span class="preprocessor"></span><span class="comment">/* </span>
00335 <span class="comment">&lt;rant&gt; Sybase does an awful job of this stuff, non null ints of size 1 2 </span>
00336 <span class="comment">and 4 have there own codes but nullable ints are lumped into INTN</span>
00337 <span class="comment">sheesh! &lt;/rant&gt;</span>
00338 <span class="comment">*/</span>
00339 <span class="keyword">typedef</span> <span class="keyword">enum</span>
00340 {
00341         SYBCHAR = 47,           <span class="comment">/* 0x2F */</span>
00342 <span class="preprocessor">#define SYBCHAR SYBCHAR</span>
00343 <span class="preprocessor"></span>        SYBVARCHAR = 39,        <span class="comment">/* 0x27 */</span>
00344 <span class="preprocessor">#define SYBVARCHAR      SYBVARCHAR</span>
00345 <span class="preprocessor"></span>        SYBINTN = 38,           <span class="comment">/* 0x26 */</span>
00346 <span class="preprocessor">#define SYBINTN SYBINTN</span>
00347 <span class="preprocessor"></span>        SYBINT1 = 48,           <span class="comment">/* 0x30 */</span>
00348 <span class="preprocessor">#define SYBINT1 SYBINT1</span>
00349 <span class="preprocessor"></span>        SYBINT2 = 52,           <span class="comment">/* 0x34 */</span>
00350 <span class="preprocessor">#define SYBINT2 SYBINT2</span>
00351 <span class="preprocessor"></span>        SYBINT4 = 56,           <span class="comment">/* 0x38 */</span>
00352 <span class="preprocessor">#define SYBINT4 SYBINT4</span>
00353 <span class="preprocessor"></span>        SYBINT8 = 127,          <span class="comment">/* 0x7F */</span>
00354 <span class="preprocessor">#define SYBINT8 SYBINT8</span>
00355 <span class="preprocessor"></span>        SYBFLT8 = 62,           <span class="comment">/* 0x3E */</span>
00356 <span class="preprocessor">#define SYBFLT8 SYBFLT8</span>
00357 <span class="preprocessor"></span>        SYBDATETIME = 61,       <span class="comment">/* 0x3D */</span>
00358 <span class="preprocessor">#define SYBDATETIME     SYBDATETIME</span>
00359 <span class="preprocessor"></span>        SYBBIT = 50,            <span class="comment">/* 0x32 */</span>
00360 <span class="preprocessor">#define SYBBIT  SYBBIT</span>
00361 <span class="preprocessor"></span>        SYBTEXT = 35,           <span class="comment">/* 0x23 */</span>
00362 <span class="preprocessor">#define SYBTEXT SYBTEXT</span>
00363 <span class="preprocessor"></span>        SYBNTEXT = 99,          <span class="comment">/* 0x63 */</span>
00364 <span class="preprocessor">#define SYBNTEXT        SYBNTEXT</span>
00365 <span class="preprocessor"></span>        SYBIMAGE = 34,          <span class="comment">/* 0x22 */</span>
00366 <span class="preprocessor">#define SYBIMAGE        SYBIMAGE</span>
00367 <span class="preprocessor"></span>        SYBMONEY4 = 122,        <span class="comment">/* 0x7A */</span>
00368 <span class="preprocessor">#define SYBMONEY4       SYBMONEY4</span>
00369 <span class="preprocessor"></span>        SYBMONEY = 60,          <span class="comment">/* 0x3C */</span>
00370 <span class="preprocessor">#define SYBMONEY        SYBMONEY</span>
00371 <span class="preprocessor"></span>        SYBDATETIME4 = 58,      <span class="comment">/* 0x3A */</span>
00372 <span class="preprocessor">#define SYBDATETIME4    SYBDATETIME4</span>
00373 <span class="preprocessor"></span>        SYBREAL = 59,           <span class="comment">/* 0x3B */</span>
00374 <span class="preprocessor">#define SYBREAL SYBREAL</span>
00375 <span class="preprocessor"></span>        SYBBINARY = 45,         <span class="comment">/* 0x2D */</span>
00376 <span class="preprocessor">#define SYBBINARY       SYBBINARY</span>
00377 <span class="preprocessor"></span>        SYBVOID = 31,           <span class="comment">/* 0x1F */</span>
00378 <span class="preprocessor">#define SYBVOID SYBVOID</span>
00379 <span class="preprocessor"></span>        SYBVARBINARY = 37,      <span class="comment">/* 0x25 */</span>
00380 <span class="preprocessor">#define SYBVARBINARY    SYBVARBINARY</span>
00381 <span class="preprocessor"></span>        SYBNVARCHAR = 103,      <span class="comment">/* 0x67 */</span>
00382 <span class="preprocessor">#define SYBNVARCHAR     SYBNVARCHAR</span>
00383 <span class="preprocessor"></span>        SYBBITN = 104,          <span class="comment">/* 0x68 */</span>
00384 <span class="preprocessor">#define SYBBITN SYBBITN</span>
00385 <span class="preprocessor"></span>        SYBNUMERIC = 108,       <span class="comment">/* 0x6C */</span>
00386 <span class="preprocessor">#define SYBNUMERIC      SYBNUMERIC</span>
00387 <span class="preprocessor"></span>        SYBDECIMAL = 106,       <span class="comment">/* 0x6A */</span>
00388 <span class="preprocessor">#define SYBDECIMAL      SYBDECIMAL</span>
00389 <span class="preprocessor"></span>        SYBFLTN = 109,          <span class="comment">/* 0x6D */</span>
00390 <span class="preprocessor">#define SYBFLTN SYBFLTN</span>
00391 <span class="preprocessor"></span>        SYBMONEYN = 110,        <span class="comment">/* 0x6E */</span>
00392 <span class="preprocessor">#define SYBMONEYN       SYBMONEYN</span>
00393 <span class="preprocessor"></span>        SYBDATETIMN = 111,      <span class="comment">/* 0x6F */</span>
00394 <span class="preprocessor">#define SYBDATETIMN     SYBDATETIMN</span>
00395 <span class="preprocessor"></span>        XSYBCHAR = 175,         <span class="comment">/* 0xAF */</span>
00396 <span class="preprocessor">#define XSYBCHAR        XSYBCHAR</span>
00397 <span class="preprocessor"></span>        XSYBVARCHAR = 167,      <span class="comment">/* 0xA7 */</span>
00398 <span class="preprocessor">#define XSYBVARCHAR     XSYBVARCHAR</span>
00399 <span class="preprocessor"></span>        XSYBNVARCHAR = 231,     <span class="comment">/* 0xE7 */</span>
00400 <span class="preprocessor">#define XSYBNVARCHAR    XSYBNVARCHAR</span>
00401 <span class="preprocessor"></span>        XSYBNCHAR = 239,        <span class="comment">/* 0xEF */</span>
00402 <span class="preprocessor">#define XSYBNCHAR       XSYBNCHAR</span>
00403 <span class="preprocessor"></span>        XSYBVARBINARY = 165,    <span class="comment">/* 0xA5 */</span>
00404 <span class="preprocessor">#define XSYBVARBINARY   XSYBVARBINARY</span>
00405 <span class="preprocessor"></span>        XSYBBINARY = 173,       <span class="comment">/* 0xAD */</span>
00406 <span class="preprocessor">#define XSYBBINARY      XSYBBINARY</span>
00407 <span class="preprocessor"></span>        SYBLONGBINARY = 225,    <span class="comment">/* 0xE1 */</span>
00408 <span class="preprocessor">#define SYBLONGBINARY   SYBLONGBINARY</span>
00409 <span class="preprocessor"></span>        SYBSINT1 = 64,          <span class="comment">/* 0x40 */</span>
00410 <span class="preprocessor">#define SYBSINT1        SYBSINT1</span>
00411 <span class="preprocessor"></span>        SYBUINT2 = 65,          <span class="comment">/* 0x41 */</span>
00412 <span class="preprocessor">#define SYBUINT2        SYBUINT2</span>
00413 <span class="preprocessor"></span>        SYBUINT4 = 66,          <span class="comment">/* 0x42 */</span>
00414 <span class="preprocessor">#define SYBUINT4        SYBUINT4</span>
00415 <span class="preprocessor"></span>        SYBUINT8 = 67,          <span class="comment">/* 0x43 */</span>
00416 <span class="preprocessor">#define SYBUINT8        SYBUINT8</span>
00417 <span class="preprocessor"></span>
00418         SYBUNIQUE = 36,         <span class="comment">/* 0x24 */</span>
00419 <span class="preprocessor">#define SYBUNIQUE       SYBUNIQUE</span>
00420 <span class="preprocessor"></span>        SYBVARIANT = 98         <span class="comment">/* 0x62 */</span>
00421 <span class="preprocessor">#define SYBVARIANT      SYBVARIANT</span>
00422 <span class="preprocessor"></span>} TDS_SERVER_TYPE;
00423 
00424 
00425 <span class="keyword">typedef</span> <span class="keyword">enum</span>
00426 {
00427         USER_UNICHAR_TYPE = 34,         <span class="comment">/* 0x22 */</span>
00428         USER_UNIVARCHAR_TYPE = 35       <span class="comment">/* 0x23 */</span>
00429 } TDS_USER_TYPE;
00430 
00431 <span class="preprocessor">#define SYBAOPCNT  0x4b</span>
00432 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPCNTU 0x4c</span>
00433 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPSUM  0x4d</span>
00434 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPSUMU 0x4e</span>
00435 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPAVG  0x4f</span>
00436 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPAVGU 0x50</span>
00437 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPMIN  0x51</span>
00438 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPMAX  0x52</span>
00439 <span class="preprocessor"></span>
00440 <span class="comment">/* mssql2k compute operator */</span>
00441 <span class="preprocessor">#define SYBAOPCNT_BIG           0x09</span>
00442 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPSTDEV             0x30</span>
00443 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPSTDEVP            0x31</span>
00444 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPVAR               0x32</span>
00445 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPVARP              0x33</span>
00446 <span class="preprocessor"></span><span class="preprocessor">#define SYBAOPCHECKSUM_AGG      0x72</span>
00447 <span class="preprocessor"></span>
00448 
<a name="l00452"></a><a class="code" href="a00273.html#a570">00452</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
00453 {
00454           TDS_OPT_SET = 1       <span class="comment">/* Set an option. */</span>
00455         , TDS_OPT_DEFAULT = 2   <span class="comment">/* Set option to its default value. */</span>
00456         , TDS_OPT_LIST = 3      <span class="comment">/* Request current setting of a specific option. */</span>
00457         , TDS_OPT_INFO = 4      <span class="comment">/* Report current setting of a specific option. */</span>
00458 } <a class="code" href="a00273.html#a570">TDS_OPTION_CMD</a>;
00459 
00460 <span class="keyword">typedef</span> <span class="keyword">enum</span>
00461 {
00462           TDS_OPT_DATEFIRST = 1         <span class="comment">/* 0x01 */</span>
00463         , TDS_OPT_TEXTSIZE = 2          <span class="comment">/* 0x02 */</span>
00464         , TDS_OPT_STAT_TIME = 3         <span class="comment">/* 0x03 */</span>
00465         , TDS_OPT_STAT_IO = 4           <span class="comment">/* 0x04 */</span>
00466         , TDS_OPT_ROWCOUNT = 5          <span class="comment">/* 0x05 */</span>
00467         , TDS_OPT_NATLANG = 6           <span class="comment">/* 0x06 */</span>
00468         , TDS_OPT_DATEFORMAT = 7        <span class="comment">/* 0x07 */</span>
00469         , TDS_OPT_ISOLATION = 8         <span class="comment">/* 0x08 */</span>
00470         , TDS_OPT_AUTHON = 9            <span class="comment">/* 0x09 */</span>
00471         , TDS_OPT_CHARSET = 10          <span class="comment">/* 0x0a */</span>
00472         , TDS_OPT_SHOWPLAN = 13         <span class="comment">/* 0x0d */</span>
00473         , TDS_OPT_NOEXEC = 14           <span class="comment">/* 0x0e */</span>
00474         , TDS_OPT_ARITHIGNOREON = 15    <span class="comment">/* 0x0f */</span>
00475         , TDS_OPT_ARITHABORTON = 17     <span class="comment">/* 0x11 */</span>
00476         , TDS_OPT_PARSEONLY = 18        <span class="comment">/* 0x12 */</span>
00477         , TDS_OPT_GETDATA = 20          <span class="comment">/* 0x14 */</span>
00478         , TDS_OPT_NOCOUNT = 21          <span class="comment">/* 0x15 */</span>
00479         , TDS_OPT_FORCEPLAN = 23        <span class="comment">/* 0x17 */</span>
00480         , TDS_OPT_FORMATONLY = 24       <span class="comment">/* 0x18 */</span>
00481         , TDS_OPT_CHAINXACTS = 25       <span class="comment">/* 0x19 */</span>
00482         , TDS_OPT_CURCLOSEONXACT = 26   <span class="comment">/* 0x1a */</span>
00483         , TDS_OPT_FIPSFLAG = 27         <span class="comment">/* 0x1b */</span>
00484         , TDS_OPT_RESTREES = 28         <span class="comment">/* 0x1c */</span>
00485         , TDS_OPT_IDENTITYON = 29       <span class="comment">/* 0x1d */</span>
00486         , TDS_OPT_CURREAD = 30          <span class="comment">/* 0x1e */</span>
00487         , TDS_OPT_CURWRITE = 31         <span class="comment">/* 0x1f */</span>
00488         , TDS_OPT_IDENTITYOFF = 32      <span class="comment">/* 0x20 */</span>
00489         , TDS_OPT_AUTHOFF = 33          <span class="comment">/* 0x21 */</span>
00490         , TDS_OPT_ANSINULL = 34         <span class="comment">/* 0x22 */</span>
00491         , TDS_OPT_QUOTED_IDENT = 35     <span class="comment">/* 0x23 */</span>
00492         , TDS_OPT_ARITHIGNOREOFF = 36   <span class="comment">/* 0x24 */</span>
00493         , TDS_OPT_ARITHABORTOFF = 37    <span class="comment">/* 0x25 */</span>
00494         , TDS_OPT_TRUNCABORT = 38       <span class="comment">/* 0x26 */</span>
00495 } TDS_OPTION;
00496 
00497 <span class="keyword">typedef</span> <span class="keyword">union </span>tds_option_arg
00498 {
00499         TDS_TINYINT ti;
00500         TDS_INT i;
00501         TDS_CHAR *c;
00502 } TDS_OPTION_ARG;
00503 
00504 <span class="keyword">enum</span> {
00505         TDS_OPT_ARITHOVERFLOW = 0x01,
00506         TDS_OPT_NUMERICTRUNC = 0x02
00507 };
00508 
00509 <span class="keyword">enum</span> TDS_OPT_DATEFIRST_CHOICE
00510 {
00511         TDS_OPT_MONDAY = 1, TDS_OPT_TUESDAY = 2, TDS_OPT_WEDNESDAY = 3, TDS_OPT_THURSDAY = 4, TDS_OPT_FRIDAY = 5, TDS_OPT_SATURDAY =
00512                 6, TDS_OPT_SUNDAY = 7
00513 };
00514 
00515 <span class="keyword">enum</span> TDS_OPT_DATEFORMAT_CHOICE
00516 {
00517         TDS_OPT_FMTMDY = 1, TDS_OPT_FMTDMY = 2, TDS_OPT_FMTYMD = 3, TDS_OPT_FMTYDM = 4, TDS_OPT_FMTMYD = 5, TDS_OPT_FMTDYM = 6
00518 };
00519 <span class="keyword">enum</span> TDS_OPT_ISOLATION_CHOICE
00520 {
00521         TDS_OPT_LEVEL1 = 1, TDS_OPT_LEVEL3 = 3
00522 };
00523 
00524 <span class="preprocessor">#define TDS_ZERO_FREE(x) {free((x)); (x) = NULL;}</span>
00525 <span class="preprocessor"></span><span class="preprocessor">#define TDS_VECTOR_SIZE(x) (sizeof(x)/sizeof(x[0]))</span>
00526 <span class="preprocessor"></span>
00527 <span class="preprocessor">#define TDS_BYTE_SWAP16(value)                 \</span>
00528 <span class="preprocessor">         (((((unsigned short)value)&lt;&lt;8) &amp; 0xFF00)   | \</span>
00529 <span class="preprocessor">          ((((unsigned short)value)&gt;&gt;8) &amp; 0x00FF))</span>
00530 <span class="preprocessor"></span>
00531 <span class="preprocessor">#define TDS_BYTE_SWAP32(value)                     \</span>
00532 <span class="preprocessor">         (((((unsigned long)value)&lt;&lt;24) &amp; 0xFF000000)  | \</span>
00533 <span class="preprocessor">          ((((unsigned long)value)&lt;&lt; 8) &amp; 0x00FF0000)  | \</span>
00534 <span class="preprocessor">          ((((unsigned long)value)&gt;&gt; 8) &amp; 0x0000FF00)  | \</span>
00535 <span class="preprocessor">          ((((unsigned long)value)&gt;&gt;24) &amp; 0x000000FF))</span>
00536 <span class="preprocessor"></span>
00537 <span class="preprocessor">#define is_end_token(x) (x==TDS_DONE_TOKEN    || \</span>
00538 <span class="preprocessor">                        x==TDS_DONEPROC_TOKEN    || \</span>
00539 <span class="preprocessor">                        x==TDS_DONEINPROC_TOKEN)</span>
00540 <span class="preprocessor"></span>
00541 <span class="preprocessor">#define is_hard_end_token(x) (x==TDS_DONE_TOKEN    || \</span>
00542 <span class="preprocessor">                        x==TDS_DONEPROC_TOKEN)</span>
00543 <span class="preprocessor"></span>
00544 <span class="preprocessor">#define is_msg_token(x) (x==TDS_INFO_TOKEN    || \</span>
00545 <span class="preprocessor">                        x==TDS_ERROR_TOKEN    || \</span>
00546 <span class="preprocessor">                        x==TDS_EED_TOKEN)</span>
00547 <span class="preprocessor"></span>
00548 <span class="preprocessor">#define is_result_token(x) (x==TDS_RESULT_TOKEN    || \</span>
00549 <span class="preprocessor">                        x==TDS_ROWFMT2_TOKEN || \</span>
00550 <span class="preprocessor">                        x==TDS7_RESULT_TOKEN    || \</span>
00551 <span class="preprocessor">                        x==TDS_COLFMT_TOKEN    || \</span>
00552 <span class="preprocessor">                        x==TDS_COLNAME_TOKEN)</span>
00553 <span class="preprocessor"></span>
00554 <span class="comment">/* FIX ME -- not a complete list */</span>
00555 <span class="preprocessor">#define is_fixed_type(x) (x==SYBINT1    || \</span>
00556 <span class="preprocessor">                        x==SYBINT2      || \</span>
00557 <span class="preprocessor">                        x==SYBINT4      || \</span>
00558 <span class="preprocessor">                        x==SYBINT8      || \</span>
00559 <span class="preprocessor">                        x==SYBREAL       || \</span>
00560 <span class="preprocessor">                        x==SYBFLT8      || \</span>
00561 <span class="preprocessor">                        x==SYBDATETIME  || \</span>
00562 <span class="preprocessor">                        x==SYBDATETIME4 || \</span>
00563 <span class="preprocessor">                        x==SYBBIT       || \</span>
00564 <span class="preprocessor">                        x==SYBMONEY     || \</span>
00565 <span class="preprocessor">                        x==SYBMONEY4    || \</span>
00566 <span class="preprocessor">                        x==SYBUNIQUE)</span>
00567 <span class="preprocessor"></span><span class="preprocessor">#define is_nullable_type(x) ( \</span>
00568 <span class="preprocessor">                        x==SYBBITN      || \</span>
00569 <span class="preprocessor">                     x==SYBINTN      || \</span>
00570 <span class="preprocessor">                     x==SYBFLTN      || \</span>
00571 <span class="preprocessor">                     x==SYBMONEYN    || \</span>
00572 <span class="preprocessor">                     x==SYBDATETIMN  || \</span>
00573 <span class="preprocessor">                     x==SYBCHAR      || \</span>
00574 <span class="preprocessor">                     x==SYBVARCHAR   || \</span>
00575 <span class="preprocessor">                     x==SYBBINARY    || \</span>
00576 <span class="preprocessor">                     x==SYBVARBINARY || \</span>
00577 <span class="preprocessor">                     x==SYBTEXT      || \</span>
00578 <span class="preprocessor">                     x==SYBNTEXT     || \</span>
00579 <span class="preprocessor">                     x==SYBIMAGE)</span>
00580 <span class="preprocessor"></span>
00581 <span class="preprocessor">#define is_blob_type(x) (x==SYBTEXT || x==SYBIMAGE || x==SYBNTEXT)</span>
00582 <span class="preprocessor"></span><span class="comment">/* large type means it has a two byte size field */</span>
00583 <span class="comment">/* define is_large_type(x) (x&gt;128) */</span>
00584 <span class="preprocessor">#define is_numeric_type(x) (x==SYBNUMERIC || x==SYBDECIMAL)</span>
00585 <span class="preprocessor"></span><span class="preprocessor">#define is_unicode_type(x) (x==XSYBNVARCHAR || x==XSYBNCHAR || x==SYBNTEXT)</span>
00586 <span class="preprocessor"></span><span class="preprocessor">#define is_collate_type(x) (x==XSYBVARCHAR || x==XSYBCHAR || x==SYBTEXT || x==XSYBNVARCHAR || x==XSYBNCHAR || x==SYBNTEXT)</span>
00587 <span class="preprocessor"></span><span class="preprocessor">#define is_ascii_type(x) ( x==XSYBCHAR || x==XSYBVARCHAR || x==SYBTEXT || x==SYBCHAR || x==SYBVARCHAR)</span>
00588 <span class="preprocessor"></span><span class="preprocessor">#define is_binary_type(x) (x==SYBLONGBINARY)</span>
00589 <span class="preprocessor"></span><span class="preprocessor">#define is_char_type(x) (is_unicode_type(x) || is_ascii_type(x))</span>
00590 <span class="preprocessor"></span><span class="preprocessor">#define is_similar_type(x, y) ((is_char_type(x) &amp;&amp; is_char_type(y)) || ((is_unicode_type(x) &amp;&amp; is_unicode_type(y))))</span>
00591 <span class="preprocessor"></span>
00592 
00593 <span class="preprocessor">#define TDS_MAX_CAPABILITY      22</span>
00594 <span class="preprocessor"></span><span class="preprocessor">#define MAXPRECISION            80</span>
00595 <span class="preprocessor"></span><span class="preprocessor">#define TDS_MAX_CONN            4096</span>
00596 <span class="preprocessor"></span><span class="preprocessor">#define TDS_MAX_DYNID_LEN       30</span>
00597 <span class="preprocessor"></span>
00598 <span class="comment">/* defaults to use if no others are found */</span>
00599 <span class="preprocessor">#define TDS_DEF_SERVER          "SYBASE"</span>
00600 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_BLKSZ           512</span>
00601 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_CHARSET         "iso_1"</span>
00602 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_LANG            "us_english"</span>
00603 <span class="preprocessor"></span><span class="preprocessor">#if TDS42</span>
00604 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MAJOR           4</span>
00605 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MINOR           2</span>
00606 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_PORT            1433</span>
00607 <span class="preprocessor"></span><span class="preprocessor">#elif TDS46</span>
00608 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MAJOR           4</span>
00609 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MINOR           6</span>
00610 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_PORT            4000</span>
00611 <span class="preprocessor"></span><span class="preprocessor">#elif TDS70</span>
00612 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MAJOR           7</span>
00613 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MINOR           0</span>
00614 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_PORT            1433</span>
00615 <span class="preprocessor"></span><span class="preprocessor">#elif TDS80</span>
00616 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MAJOR           8</span>
00617 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MINOR           0</span>
00618 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_PORT            1433</span>
00619 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00620 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MAJOR           5</span>
00621 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_MINOR           0</span>
00622 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DEF_PORT            4000</span>
00623 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00624 <span class="preprocessor"></span>
00625 <span class="comment">/* normalized strings from freetds.conf file */</span>
00626 <span class="preprocessor">#define TDS_STR_VERSION  "tds version"</span>
00627 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_BLKSZ    "initial block size"</span>
00628 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_SWAPDT   "swap broken dates"</span>
00629 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_SWAPMNY  "swap broken money"</span>
00630 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_TRYSVR   "try server login"</span>
00631 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_TRYDOM   "try domain login"</span>
00632 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_DOMAIN   "nt domain"</span>
00633 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_XDOMAUTH "cross domain login"</span>
00634 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_DUMPFILE "dump file"</span>
00635 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_DEBUGLVL "debug level"</span>
00636 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_TIMEOUT  "timeout"</span>
00637 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_CONNTMOUT "connect timeout"</span>
00638 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_HOSTNAME "hostname"</span>
00639 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_HOST     "host"</span>
00640 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_PORT     "port"</span>
00641 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_TEXTSZ   "text size"</span>
00642 <span class="preprocessor"></span><span class="comment">/* for big endian hosts */</span>
00643 <span class="preprocessor">#define TDS_STR_EMUL_LE "emulate little endian"</span>
00644 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_CHARSET "charset"</span>
00645 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_CLCHARSET       "client charset"</span>
00646 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_LANGUAGE        "language"</span>
00647 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_APPENDMODE      "dump file append"</span>
00648 <span class="preprocessor"></span><span class="preprocessor">#define TDS_STR_DATEFMT "date format"</span>
00649 <span class="preprocessor"></span>
00650 <span class="comment">/* TODO do a better check for alignment than this */</span>
00651 <span class="keyword">typedef</span> <span class="keyword">union</span>
00652 <span class="keyword"></span>{
00653         <span class="keywordtype">void</span> *p;
00654         <span class="keywordtype">int</span> i;
00655 } tds_align_struct;
00656 
00657 <span class="preprocessor">#define TDS_ALIGN_SIZE sizeof(tds_align_struct)</span>
00658 <span class="preprocessor"></span>
00659 <span class="preprocessor">#define TDS_MAX_LOGIN_STR_SZ 30</span>
00660 <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span>tds_login
00661 {
00662         DSTR server_name;
00663         <span class="keywordtype">int</span> port;
00664         TDS_TINYINT major_version;      <span class="comment">/* TDS version */</span>
00665         TDS_TINYINT minor_version;      <span class="comment">/* TDS version */</span>
00666         <span class="keywordtype">int</span> block_size;
00667         DSTR language;          <span class="comment">/* ie us-english */</span>
00668         DSTR server_charset;    <span class="comment">/*  ie iso_1 */</span>
00669         TDS_INT connect_timeout;
00670         DSTR host_name;
00671         DSTR app_name;
00672         DSTR user_name;
00673         DSTR password;
00674         
00675         DSTR library;   <span class="comment">/* Ct-Library, DB-Library,  TDS-Library or ODBC */</span>
00676         TDS_TINYINT bulk_copy;
00677         TDS_TINYINT suppress_language;
00678         TDS_TINYINT encrypted;
00679 
00680         TDS_INT query_timeout;
00681         TDS_INT longquery_timeout;
00682         void (*longquery_func) (<span class="keywordtype">void</span> *param);
00683         <span class="keywordtype">void</span> *longquery_param;
00684         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> capabilities[TDS_MAX_CAPABILITY];
00685         DSTR client_charset;
00686 } TDSLOGIN;
00687 
00688 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_connect_info
00689 {
00690         <span class="comment">/* first part of structure is the same of login one */</span>
00691         DSTR server_name; 
00692         <span class="keywordtype">int</span> port;          
00693         TDS_TINYINT major_version;
00694         TDS_TINYINT minor_version;
00695         <span class="keywordtype">int</span> block_size;
00696         DSTR language;
00697         DSTR server_charset;    
00698         TDS_INT connect_timeout;
00699         DSTR host_name;     
00700         DSTR app_name;
00701         DSTR user_name;     
00702         DSTR password;      
00703         DSTR library;
00704         TDS_TINYINT bulk_copy;
00705         TDS_TINYINT suppress_language;
00706         TDS_TINYINT encrypted;
00707 
00708         TDS_INT query_timeout;
00709         TDS_INT longquery_timeout;
00710         void (*longquery_func) (<span class="keywordtype">void</span> *param);
00711         <span class="keywordtype">void</span> *longquery_param;
00712         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> capabilities[TDS_MAX_CAPABILITY];
00713         DSTR client_charset;
00714 
00715         DSTR ip_addr;     
00716         DSTR database;
00717         DSTR dump_file;
00718         DSTR default_domain;
00719         <span class="keywordtype">int</span> timeout;
00720         <span class="keywordtype">int</span> debug_level;
00721         <span class="keywordtype">int</span> text_size;
00722         <span class="keywordtype">int</span> broken_dates;
00723         <span class="keywordtype">int</span> broken_money;
00724         <span class="keywordtype">int</span> try_server_login;
00725         <span class="keywordtype">int</span> try_domain_login;
00726         <span class="keywordtype">int</span> xdomain_auth;
00727         <span class="keywordtype">int</span> emul_little_endian;
00728 } TDSCONNECTINFO;
00729 
00730 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_locale
00731 {
00732         <span class="keywordtype">char</span> *language;
00733         <span class="keywordtype">char</span> *char_set;
00734         <span class="keywordtype">char</span> *date_fmt;
00735 } TDSLOCALE;
00736 
<a name="l00741"></a><a class="code" href="a00167.html">00741</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00167.html">tds_blob_info</a>
00742 {
00743         TDS_CHAR *textvalue;
00744         TDS_CHAR textptr[16];
00745         TDS_CHAR timestamp[8];
00746 } <a class="code" href="a00167.html">TDSBLOBINFO</a>;
00747 
<a name="l00751"></a><a class="code" href="a00164.html">00751</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00752 <span class="keyword"></span>{
00753         TDS_USMALLINT locale_id;        <span class="comment">/* master..syslanguages.lcid */</span>
00754         TDS_USMALLINT flags;
00755         TDS_UCHAR charset_id;           <span class="comment">/* or zero */</span>
00756 } <a class="code" href="a00164.html">TDS8_COLLATION</a>;
00757 
00758 <span class="comment">/* SF stands for "sort flag" */</span>
00759 <span class="preprocessor">#define TDS_SF_BIN                   (TDS_USMALLINT) 0x100</span>
00760 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SF_WIDTH_INSENSITIVE     (TDS_USMALLINT) 0x080</span>
00761 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SF_KATATYPE_INSENSITIVE  (TDS_USMALLINT) 0x040</span>
00762 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SF_ACCENT_SENSITIVE      (TDS_USMALLINT) 0x020</span>
00763 <span class="preprocessor"></span><span class="preprocessor">#define TDS_SF_CASE_INSENSITIVE      (TDS_USMALLINT) 0x010</span>
00764 <span class="preprocessor"></span>
00765 
<a name="l00770"></a><a class="code" href="a00132.html">00770</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00132.html">_tds_encoding</a>
00771 {
00772         <span class="keyword">const</span> <span class="keywordtype">char</span> *name;
00773         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> min_bytes_per_char;
00774         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> max_bytes_per_char;
00775 } <a class="code" href="a00132.html">TDS_ENCODING</a>;
00776 
00777 
00778 <span class="keyword">enum</span>
00779 { TDS_SYSNAME_SIZE = 512 };
00780 
<a name="l00784"></a><a class="code" href="a00168.html">00784</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00168.html">tds_column_info</a>
00785 {
00786         TDS_SMALLINT <a class="code" href="a00168.html#m0">column_type</a>;       
00791         TDS_INT column_usertype;
00792         TDS_INT column_flags;
00793 
00794         TDS_INT <a class="code" href="a00168.html#m3">column_size</a>;            
<a name="l00796"></a><a class="code" href="a00168.html#m4">00796</a>         TDS_TINYINT <a class="code" href="a00168.html#m4">column_varint_size</a>; 
<a name="l00798"></a><a class="code" href="a00168.html#m5">00798</a>         TDS_TINYINT <a class="code" href="a00168.html#m5">column_prec</a>;        
<a name="l00799"></a><a class="code" href="a00168.html#m6">00799</a>         TDS_TINYINT <a class="code" href="a00168.html#m6">column_scale</a>;       
<a name="l00801"></a><a class="code" href="a00168.html#m7">00801</a>         TDS_TINYINT <a class="code" href="a00168.html#m7">column_namelen</a>;     
00802         TDS_TINYINT table_namelen;
00803         <span class="keyword">struct</span>
00804 <span class="keyword">        </span>{
<a name="l00805"></a><a class="code" href="a00168.html#m0">00805</a>                 TDS_SMALLINT column_type;       
<a name="l00806"></a><a class="code" href="a00168.html#m3">00806</a>                 TDS_INT column_size;
00807         } on_server;
00808 
<a name="l00809"></a><a class="code" href="a00168.html#m10">00809</a>         <span class="keyword">const</span> TDSICONVINFO *<a class="code" href="a00168.html#m10">iconv_info</a>; 
00811         TDS_CHAR table_name[TDS_SYSNAME_SIZE];
00812         TDS_CHAR column_name[TDS_SYSNAME_SIZE];
00813 
<a name="l00814"></a><a class="code" href="a00168.html#m13">00814</a>         TDS_INT <a class="code" href="a00168.html#m13">column_offset</a>;          
00815         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_nullable:1;
00816         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_writeable:1;
00817         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_identity:1;
00818         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_key:1;
00819         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_hidden:1;
00820         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> column_output:1;
00821         TDS_UCHAR column_collation[5];
00822 
00823         <span class="comment">/* additional fields flags for compute results */</span>
00824         TDS_TINYINT column_operator;
00825         TDS_SMALLINT column_operand;
00826 
00827         <span class="comment">/* FIXME this is data related, not column */</span>
<a name="l00829"></a><a class="code" href="a00168.html#m23">00829</a>         TDS_INT <a class="code" href="a00168.html#m23">column_cur_size</a>;
00830 
00831         <span class="comment">/* related to binding or info stored by client libraries */</span>
00832         <span class="comment">/* FIXME find a best place to store these data, some are unused */</span>
00833         TDS_SMALLINT column_bindtype;
00834         TDS_SMALLINT column_bindfmt;
00835         TDS_UINT column_bindlen;
00836         TDS_CHAR *column_nullbind;
00837         TDS_CHAR *column_varaddr;
00838         TDS_CHAR *column_lenbind;
00839         TDS_INT column_textpos;
00840         TDS_INT column_text_sqlgetdatapos;
00841 } <a class="code" href="a00168.html">TDSCOLINFO</a>;
00842 
00843 <span class="keyword">typedef</span> <span class="keyword">struct</span>
00844 <span class="keyword"></span>{
00845         <span class="keywordtype">int</span> tab_colnum;
00846         <span class="keywordtype">char</span> db_name[256];      <span class="comment">/* column name */</span>
00847         TDS_SMALLINT db_minlen;
00848         TDS_SMALLINT db_maxlen;
00849         TDS_SMALLINT db_colcnt; <span class="comment">/* I don't know what this does */</span>
00850         TDS_TINYINT db_type;
00851         <span class="keyword">struct</span>
00852 <span class="keyword">        </span>{
00853                 TDS_SMALLINT column_type;       
00854                 TDS_INT column_size;
00855         } on_server;
00856         <span class="keyword">const</span> TDSICONVINFO *iconv_info; 
00857         TDS_SMALLINT db_usertype;
00858         TDS_TINYINT db_varint_size;
00859         TDS_INT db_length;      <span class="comment">/* size of field according to database */</span>
00860         TDS_TINYINT db_nullable;
00861         TDS_TINYINT db_status;
00862         TDS_SMALLINT db_offset;
00863         TDS_TINYINT db_default;
00864         TDS_TINYINT db_prec;
00865         TDS_TINYINT db_scale;
00866         TDS_SMALLINT db_flags;
00867         TDS_INT db_size;
00868         <span class="keywordtype">char</span> db_collate[5];
00869         <span class="keywordtype">long</span> data_size;
00870         TDS_TINYINT *data;
00871         <span class="keywordtype">int</span> txptr_offset;
00872 } BCP_COLINFO;
00873 
00874 
<a name="l00876"></a><a class="code" href="a00181.html">00876</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00181.html">tds_result_info</a>
00877 {
00878         <span class="comment">/* TODO those fields can became a struct */</span>
00879         TDS_SMALLINT num_cols;
00880         <a class="code" href="a00168.html">TDSCOLINFO</a> **columns;
00881         TDS_INT row_size;
00882         <span class="keywordtype">int</span> null_info_size;
00883         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *current_row;
00884 
00885         TDS_SMALLINT rows_exist;
00886         TDS_INT row_count;
00887         TDS_SMALLINT computeid;
00888         TDS_TINYINT more_results;
00889         TDS_TINYINT *bycolumns;
00890         TDS_SMALLINT by_cols;
00891 } <a class="code" href="a00181.html">TDSRESULTINFO</a>;
00892 
00893 <span class="comment">/* values for tds-&gt;state */</span>
00894 <span class="keyword">enum</span>
00895 {
00896         TDS_QUERYING,
00897         TDS_PENDING,
00898         TDS_IDLE,
00899         TDS_CANCELED,
00900         TDS_DEAD
00901 };
00902 
00903 <span class="preprocessor">#define TDS_DBG_FUNC    7</span>
00904 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DBG_INFO2   6</span>
00905 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DBG_INFO1   5</span>
00906 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DBG_NETWORK 4</span>
00907 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DBG_WARN    3</span>
00908 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DBG_ERROR   2</span>
00909 <span class="preprocessor"></span><span class="preprocessor">#define TDS_DBG_SEVERE  1</span>
00910 <span class="preprocessor"></span>
<a name="l00916"></a><a class="code" href="a00273.html#a578">00916</a> <span class="keyword">enum</span> <a class="code" href="a00273.html#a578">TDS_DBG_LOG_STATE</a>
00917 {
00918           TDS_DBG_LOGIN = 1             <span class="comment">/* for diagnosing login problems;                                       </span>
00919 <span class="comment">                                           otherwise the username/password information is suppressed. */</span>
00920         , TDS_DBG_API =    (1 &lt;&lt; 1)     <span class="comment">/* Log calls to client libraries */</span>
00921         , TDS_DBG_ASYNC =  (1 &lt;&lt; 2)     <span class="comment">/* Log asynchronous function starts or completes. */</span>
00922         , TDS_DBG_DIAG =   (1 &lt;&lt; 3)     <span class="comment">/* Log client- and server-generated messages */</span>
00923         , TDS_DBG_error =  (1 &lt;&lt; 4)
00924         <span class="comment">/* TODO:  ^^^^^ make upper case when old #defines (above) are removed */</span>
00925         <span class="comment">/* Log FreeTDS runtime/logic error occurs. */</span>
00926         , TDS_DBG_PACKET = (1 &lt;&lt; 5)     <span class="comment">/* Log hex dump of packets to/from the server. */</span>
00927         , TDS_DBG_LIBTDS = (1 &lt;&lt; 6)     <span class="comment">/* Log calls to (and in) libtds */</span>
00928         , TDS_DBG_CONFIG = (1 &lt;&lt; 7)     <span class="comment">/* replaces TDSDUMPCONFIG */</span>
00929         , TDS_DBG_DEFAULT = 0xFE        <span class="comment">/* all above except login packets */</span>
00930 };
00931 
00932 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="a00181.html">tds_result_info</a> TDSCOMPUTEINFO;
00933 
00934 <span class="keyword">typedef</span> <a class="code" href="a00181.html">TDSRESULTINFO</a> <a class="code" href="a00181.html">TDSPARAMINFO</a>;
00935 
00936 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_msg_info
00937 {
00938         TDS_SMALLINT priv_msg_type;
00939         TDS_SMALLINT line_number;
00940         TDS_UINT msg_number;
00941         TDS_SMALLINT msg_state;
00942         TDS_SMALLINT msg_level;
00943         TDS_CHAR *server;
00944         TDS_CHAR *message;
00945         TDS_CHAR *proc_name;
00946         TDS_CHAR *sql_state;
00947 } TDSMSGINFO;
00948 
00949 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_upd_col
00950 {
00951         <span class="keyword">struct </span>tds_upd_col *next;       
00952         TDS_INT colnamelength;
00953         <span class="keywordtype">char</span> * columnname;
00954 } TDSUPDCOL;
00955 
00956 <span class="keyword">typedef</span> <span class="keyword">enum</span> {
00957           TDS_CURSOR_STATE_UNACTIONED = 0
00958         , TDS_CURSOR_STATE_REQUESTED = 1        <span class="comment">/* called by ct_cursor */</span> 
00959         , TDS_CURSOR_STATE_SENT = 2             <span class="comment">/* sent to server and ack */</span>
00960 } TDS_CURSOR_STATE;
00961 
00962 <span class="keyword">typedef</span> <span class="keyword">struct </span>_tds_cursor_status
00963 {
00964         TDS_CURSOR_STATE declare;
00965         TDS_CURSOR_STATE cursor_row;
00966         TDS_CURSOR_STATE open;
00967         TDS_CURSOR_STATE fetch;
00968         TDS_CURSOR_STATE close; 
00969         TDS_CURSOR_STATE dealloc;
00970 } TDS_CURSOR_STATUS;
00971 
00972 <span class="keyword">typedef</span> <span class="keyword">struct </span>_tds_cursor 
00973 {
00974         TDS_INT length;                 <span class="comment">/* total length of the remaining datastream */</span>
00975         TDS_TINYINT cursor_name_len;    <span class="comment">/* length of cursor name &gt; 0 and &lt;= 30  */</span>
00976         <span class="keywordtype">char</span> *cursor_name;              <span class="comment">/* name of the cursor */</span>
00977         TDS_INT cursor_id;              <span class="comment">/* cursor id returned by the server after cursor declare */</span>
00978         TDS_TINYINT options;            <span class="comment">/* read only|updatable */</span>
00979         TDS_TINYINT hasargs;            <span class="comment">/* cursor parameters exists ? */</span>
00980         TDS_USMALLINT query_len;        <span class="comment">/* SQL query length */</span>
00981         <span class="keywordtype">char</span> *query;                    <span class="comment">/* SQL query */</span>
00982         <span class="comment">/* TODO for updatable columns */</span>
00983         TDS_TINYINT number_upd_cols;    <span class="comment">/* number of updatable columns */</span>
00984         TDS_INT cursor_rows;            <span class="comment">/* number of cursor rows to fetch */</span>
00985         <span class="comment">/*TODO when cursor has parameters*/</span>
00986         <span class="comment">/*TDS_PARAM *param_list;         cursor parameter */</span>
00987         TDSUPDCOL *cur_col_list;        <span class="comment">/* updatable column list */</span>
00988         TDS_CURSOR_STATUS status;
00989 } TDS_CURSOR;
00990 
00991 <span class="comment">/*</span>
00992 <span class="comment"> * Current environment as reported by the server</span>
00993 <span class="comment"> */</span>
00994 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_env_info
00995 {
00996         <span class="keywordtype">int</span> block_size;
00997         <span class="keywordtype">char</span> *language;
00998         <span class="keywordtype">char</span> *charset;
00999         <span class="keywordtype">char</span> *database;
01000 } TDSENVINFO;
01001 
01002 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_dynamic
01003 {
01004         <span class="keywordtype">char</span> id[30];
01005         <span class="keywordtype">int</span> dyn_state;
01007         TDS_INT num_id;
01008         TDSPARAMINFO *res_info;
01009         TDSPARAMINFO *params;
01010         <span class="keywordtype">int</span> emulated;
01012         <span class="keywordtype">char</span> *query;
01013 } TDSDYNAMIC;
01014 
01015 <span class="comment">/* forward declaration */</span>
01016 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_context TDSCONTEXT;
01017 
01018 <span class="keyword">struct </span>tds_context
01019 {
01020         TDSLOCALE *locale;
01021         <span class="keywordtype">void</span> *parent;
01022         <span class="comment">/* handler */</span>
01023         int (*msg_handler) (TDSCONTEXT *, TDSSOCKET *, TDSMSGINFO *);
01024         int (*err_handler) (TDSCONTEXT *, TDSSOCKET *, TDSMSGINFO *);
01025 };
01026 
01027 <span class="keyword">enum</span> TDS_ICONV_INFO_ENTRY
01028 { 
01029           client2ucs2
01030         , client2server_chardata
01031         , iso2server_metadata
01032         , initial_iconv_info_count      <span class="comment">/* keep last */</span>
01033 };
01034 
01035 <span class="keyword">struct </span>tds_socket
01036 {
01037         <span class="comment">/* fixed and connect time */</span>
01038         TDS_SYS_SOCKET s;
01039         TDS_SMALLINT major_version;
01040         TDS_SMALLINT minor_version;
01042         TDS_UINT product_version;
01043         <span class="keywordtype">char</span> *product_name;
01044         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> capabilities[TDS_MAX_CAPABILITY];
01045         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> broken_dates;
01046         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> option_flag2;
01047         <span class="comment">/* in/out buffers */</span>
01048         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *in_buf;
01049         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *out_buf;
01050         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> in_buf_max;
01051         <span class="keywordtype">unsigned</span> in_pos;
01052         <span class="keywordtype">unsigned</span> out_pos;
01053         <span class="keywordtype">unsigned</span> in_len;
01054         <span class="keywordtype">unsigned</span> out_len;
01055         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> out_flag;
01056         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> last_packet;
01057         <span class="keywordtype">void</span> *parent;
01058         <span class="comment">/* info about current query. </span>
01059 <span class="comment">         * Contain information in process, even normal results and compute.</span>
01060 <span class="comment">         * This pointer shouldn't be freed.</span>
01061 <span class="comment">         */</span>
01062         <a class="code" href="a00181.html">TDSRESULTINFO</a> *curr_resinfo;
01063         <a class="code" href="a00181.html">TDSRESULTINFO</a> *res_info;
01064         TDS_INT num_comp_info;
01065         TDSCOMPUTEINFO **comp_info;
01066         TDSPARAMINFO *param_info;
01067         TDS_CURSOR *cursor;
01068         TDS_TINYINT has_status;
01069         TDS_INT ret_status;
01070         TDS_TINYINT state;
01071         <span class="keywordtype">int</span> rows_affected;
01072         <span class="comment">/* timeout stuff from Jeff */</span>
01073         TDS_INT timeout;
01074         TDS_INT longquery_timeout;
01075         void (*longquery_func) (<span class="keywordtype">void</span> *param);
01076         <span class="keywordtype">void</span> *longquery_param;
01077         time_t queryStarttime;
01078         TDSENVINFO *env;
01079         <span class="comment">/* dynamic placeholder stuff */</span>
01080         <span class="keywordtype">int</span> num_dyns;
01081         TDSDYNAMIC *cur_dyn;
01082         TDSDYNAMIC **dyns;
01083         <span class="keywordtype">int</span> emul_little_endian;
01084         <span class="keywordtype">char</span> *date_fmt;
01085         TDSCONTEXT *tds_ctx;
01086         <span class="keywordtype">int</span> iconv_info_count;
01087         TDSICONVINFO **iconv_info;
01088 
01090         TDSCONNECTINFO *connect_info;
01091         <span class="keywordtype">int</span> spid;
01092         TDS_UCHAR collation[5];
01093         void (*env_chg_func) (TDSSOCKET * tds, <span class="keywordtype">int</span> type, <span class="keywordtype">char</span> *oldval, <span class="keywordtype">char</span> *newval);
01094         int (*chkintr) (TDSSOCKET * tds);
01095         int (*hndlintr) (TDSSOCKET * tds);
01096     <span class="keywordtype">int</span> internal_sp_called;
01097 };
01098 
01099 <span class="keywordtype">void</span> tds_set_longquery_handler(TDSLOGIN * tds_login, <span class="keywordtype">void</span> (*longquery_func) (<span class="keywordtype">void</span> *param), <span class="keywordtype">void</span> *longquery_param);
01100 <span class="keywordtype">void</span> tds_set_timeouts(TDSLOGIN * tds_login, <span class="keywordtype">int</span> connect_timeout, <span class="keywordtype">int</span> query_timeout, <span class="keywordtype">int</span> longquery_timeout);
01101 <span class="keywordtype">int</span> tds_init_write_buf(TDSSOCKET * tds);
01102 <span class="keywordtype">void</span> tds_free_result_info(<a class="code" href="a00181.html">TDSRESULTINFO</a> * info);
01103 <span class="keywordtype">void</span> tds_free_socket(TDSSOCKET * tds);
01104 <span class="keywordtype">void</span> tds_free_connect(TDSCONNECTINFO * connect_info);
01105 <span class="keywordtype">void</span> tds_free_all_results(TDSSOCKET * tds);
01106 <span class="keywordtype">void</span> tds_free_results(<a class="code" href="a00181.html">TDSRESULTINFO</a> * res_info);
01107 <span class="keywordtype">void</span> tds_free_param_results(TDSPARAMINFO * param_info);
01108 <span class="keywordtype">void</span> tds_free_msg(TDSMSGINFO * msg_info);
01109 <span class="keywordtype">void</span> tds_free_cursor(TDS_CURSOR *cursor);
01110 <span class="keywordtype">int</span> tds_put_n(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">void</span> *buf, <span class="keywordtype">int</span> n);
01111 <span class="keywordtype">int</span> <a class="code" href="a00308.html#a13">tds_put_string</a>(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> len);
01112 <span class="keywordtype">int</span> tds_put_int(TDSSOCKET * tds, TDS_INT i);
01113 <span class="keywordtype">int</span> tds_put_int8(TDSSOCKET * tds, TDS_INT8 i);
01114 <span class="keywordtype">int</span> tds_put_smallint(TDSSOCKET * tds, TDS_SMALLINT si);
01115 <span class="keywordtype">int</span> tds_put_tinyint(TDSSOCKET * tds, TDS_TINYINT ti);
01116 <span class="keywordtype">int</span> tds_put_byte(TDSSOCKET * tds, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c);
01117 <a class="code" href="a00181.html">TDSRESULTINFO</a> *tds_alloc_results(<span class="keywordtype">int</span> num_cols);
01118 TDSCOMPUTEINFO **tds_alloc_compute_results(TDS_INT * num_comp_results, TDSCOMPUTEINFO ** ci, <span class="keywordtype">int</span> num_cols, <span class="keywordtype">int</span> by_cols);
01119 TDSCONTEXT *tds_alloc_context(<span class="keywordtype">void</span>);
01120 <span class="keywordtype">void</span> tds_free_context(TDSCONTEXT * locale);
01121 TDSSOCKET *tds_alloc_socket(TDSCONTEXT * context, <span class="keywordtype">int</span> bufsize);
01122 
01123 <span class="comment">/* config.c */</span>
01124 <span class="keyword">const</span> <a class="code" href="a00129.html">TDS_COMPILETIME_SETTINGS</a> *<a class="code" href="a00304.html#a24">tds_get_compiletime_settings</a>(<span class="keywordtype">void</span>);
01125 <span class="keyword">typedef</span> void (*TDSCONFPARSE) (<span class="keyword">const</span> <span class="keywordtype">char</span> *option, <span class="keyword">const</span> <span class="keywordtype">char</span> *value, <span class="keywordtype">void</span> *param);
01126 <span class="keywordtype">int</span> <a class="code" href="a00304.html#a7">tds_read_conf_section</a>(FILE * in, <span class="keyword">const</span> <span class="keywordtype">char</span> *section, TDSCONFPARSE tds_conf_parse, <span class="keywordtype">void</span> *parse_param);
01127 <span class="keywordtype">int</span> <a class="code" href="a00304.html#a4">tds_read_conf_file</a>(TDSCONNECTINFO * connect_info, <span class="keyword">const</span> <span class="keywordtype">char</span> *server);
01128 TDSCONNECTINFO *<a class="code" href="a00304.html#a0">tds_read_config_info</a>(TDSSOCKET * tds, TDSLOGIN * login, TDSLOCALE * locale);
01129 <span class="keywordtype">void</span> <a class="code" href="a00304.html#a1">tds_fix_connect</a>(TDSCONNECTINFO * connect_info);
01130 <span class="keywordtype">void</span> <a class="code" href="a00304.html#a15">tds_config_verstr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *tdsver, TDSCONNECTINFO * connect_info);
01131 <span class="keywordtype">void</span> <a class="code" href="a00304.html#a17">tds_lookup_host</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *servername, <span class="keywordtype">char</span> *ip);
01132 <span class="keywordtype">int</span> <a class="code" href="a00304.html#a16">tds_set_interfaces_file_loc</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *interfloc);
01133 
01134 TDSLOCALE *tds_get_locale(<span class="keywordtype">void</span>);
01135 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="a00306.html#a10">tds_alloc_row</a>(<a class="code" href="a00181.html">TDSRESULTINFO</a> * res_info);
01136 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *tds_alloc_compute_row(TDSCOMPUTEINFO * res_info);
01137 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a31">tds_alloc_get_string</a>(TDSSOCKET * tds, <span class="keywordtype">char</span> **string, <span class="keywordtype">int</span> len);
01138 <span class="keywordtype">void</span> <a class="code" href="a00310.html#a33">tds_set_null</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *current_row, <span class="keywordtype">int</span> column);
01139 <span class="keywordtype">void</span> <a class="code" href="a00310.html#a34">tds_clr_null</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *current_row, <span class="keywordtype">int</span> column);
01140 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a35">tds_get_null</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *current_row, <span class="keywordtype">int</span> column);
01141 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *tds7_crypt_pass(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *clear_pass, <span class="keywordtype">int</span> len, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *crypt_pass);
01142 TDSDYNAMIC *<a class="code" href="a00310.html#a36">tds_lookup_dynamic</a>(TDSSOCKET * tds, <span class="keywordtype">char</span> *id);
01143 <span class="keyword">const</span> <span class="keywordtype">char</span> *tds_prtype(<span class="keywordtype">int</span> token);
01144 
01145 
01146 
01147 <span class="comment">/* iconv.c */</span>
01148 <span class="keywordtype">void</span> tds_iconv_open(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *charset);
01149 <span class="keywordtype">void</span> tds_iconv_close(TDSSOCKET * tds);
01150 <span class="keywordtype">void</span> tds_srv_charset_changed(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *charset);
01151 <span class="keywordtype">void</span> tds7_srv_charset_changed(TDSSOCKET * tds, <span class="keywordtype">int</span> lcid);
01152 <span class="keywordtype">int</span> tds_iconv_alloc(TDSSOCKET * tds);
01153 <span class="keywordtype">void</span> tds_iconv_free(TDSSOCKET * tds);
01154 TDSICONVINFO *<a class="code" href="a00302.html#a20">tds_iconv_from_lcid</a>(TDSSOCKET * tds, <span class="keywordtype">int</span> lcid);
01155 
01156 <span class="comment">/* threadsafe.c */</span>
01157 <span class="keywordtype">char</span> *tds_timestamp_str(<span class="keywordtype">char</span> *str, <span class="keywordtype">int</span> maxlen);
01158 <span class="keyword">struct </span>hostent *tds_gethostbyname_r(const char *servername, struct hostent *result, char *buffer, int buflen, int *h_errnop);
01159 <span class="keyword">struct </span>hostent *tds_gethostbyaddr_r(const char *addr, int len, int type, struct hostent *result, char *buffer, int buflen,
01160                                     int *h_errnop);
01161 <span class="keyword">struct </span>servent *tds_getservbyname_r(const char *name, const char *proto, struct servent *result, char *buffer, int buflen);
01162 <span class="keywordtype">char</span> *tds_get_homedir(<span class="keywordtype">void</span>);
01163 
01164 <span class="comment">/* mem.c */</span>
01165 TDSPARAMINFO *<a class="code" href="a00306.html#a5">tds_alloc_param_result</a>(TDSPARAMINFO * old_param);
01166 <span class="keywordtype">void</span> <a class="code" href="a00306.html#a2">tds_free_input_params</a>(TDSDYNAMIC * dyn);
01167 <span class="keywordtype">void</span> <a class="code" href="a00306.html#a4">tds_free_all_dynamic</a>(TDSSOCKET * tds);
01168 <span class="keywordtype">void</span> <a class="code" href="a00306.html#a3">tds_free_dynamic</a>(TDSSOCKET * tds, TDSDYNAMIC * dyn);
01169 TDSSOCKET *tds_realloc_socket(TDSSOCKET * tds, <span class="keywordtype">int</span> bufsize);
01170 <span class="keywordtype">void</span> tds_free_compute_result(TDSCOMPUTEINFO * comp_info);
01171 <span class="keywordtype">void</span> tds_free_compute_results(TDSCOMPUTEINFO ** comp_info, TDS_INT num_comp);
01172 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<a class="code" href="a00306.html#a6">tds_alloc_param_row</a>(TDSPARAMINFO * info, <a class="code" href="a00168.html">TDSCOLINFO</a> * curparam);
01173 <span class="keywordtype">char</span> *tds_alloc_client_sqlstate(<span class="keywordtype">int</span> msgnum);
01174 <span class="keywordtype">char</span> *tds_alloc_lookup_sqlstate(TDSSOCKET * tds, <span class="keywordtype">int</span> msgnum);
01175 TDSLOGIN *tds_alloc_login(<span class="keywordtype">void</span>);
01176 TDSDYNAMIC *<a class="code" href="a00306.html#a1">tds_alloc_dynamic</a>(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *id);
01177 <span class="keywordtype">void</span> tds_free_login(TDSLOGIN * login);
01178 TDSCONNECTINFO *<a class="code" href="a00306.html#a20">tds_alloc_connect</a>(TDSLOCALE * locale);
01179 TDSLOCALE *tds_alloc_locale(<span class="keywordtype">void</span>);
01180 <span class="keywordtype">void</span> tds_free_locale(TDSLOCALE * locale);
01181 TDS_CURSOR * tds_alloc_cursor(<span class="keywordtype">char</span> *name, TDS_INT namelen, <span class="keywordtype">char</span> *query, TDS_INT querylen);
01182 
01183 <span class="comment">/* login.c */</span>
01184 <span class="keywordtype">int</span> tds7_send_auth(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *challenge);
01185 <span class="keywordtype">void</span> tds_set_packet(TDSLOGIN * tds_login, <span class="keywordtype">int</span> packet_size);
01186 <span class="keywordtype">void</span> tds_set_port(TDSLOGIN * tds_login, <span class="keywordtype">int</span> port);
01187 <span class="keywordtype">void</span> tds_set_passwd(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *password);
01188 <span class="keywordtype">void</span> tds_set_bulk(TDSLOGIN * tds_login, TDS_TINYINT enabled);
01189 <span class="keywordtype">void</span> tds_set_user(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *username);
01190 <span class="keywordtype">void</span> tds_set_app(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *application);
01191 <span class="keywordtype">void</span> tds_set_host(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *hostname);
01192 <span class="keywordtype">void</span> tds_set_library(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *library);
01193 <span class="keywordtype">void</span> tds_set_server(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *server);
01194 <span class="keywordtype">void</span> tds_set_client_charset(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *charset);
01195 <span class="keywordtype">void</span> tds_set_language(TDSLOGIN * tds_login, <span class="keyword">const</span> <span class="keywordtype">char</span> *language);
01196 <span class="keywordtype">void</span> tds_set_version(TDSLOGIN * tds_login, <span class="keywordtype">short</span> major_ver, <span class="keywordtype">short</span> minor_ver);
01197 <span class="keywordtype">void</span> tds_set_capabilities(TDSLOGIN * tds_login, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *capabilities, <span class="keywordtype">int</span> size);
01198 <span class="keywordtype">int</span> tds_connect(TDSSOCKET * tds, TDSCONNECTINFO * connect_info);
01199 
01200 <span class="comment">/* query.c */</span>
01201 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a3">tds_submit_query</a>(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *query);
01202 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a4">tds_submit_query_params</a>(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *query, TDSPARAMINFO * params);
01203 <span class="keywordtype">int</span> tds_submit_queryf(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *queryf, ...);
01204 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a16">tds_submit_prepare</a>(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *query, <span class="keyword">const</span> <span class="keywordtype">char</span> *id, TDSDYNAMIC ** dyn_out, TDSPARAMINFO * params);
01205 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a17">tds_submit_execdirect</a>(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *query, TDSPARAMINFO * params);
01206 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a21">tds_submit_execute</a>(TDSSOCKET * tds, TDSDYNAMIC * dyn);
01207 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a26">tds_send_cancel</a>(TDSSOCKET * tds);
01208 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00307.html#a8">tds_next_placeholders</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *start);
01209 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a9">tds_count_placeholders</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *query);
01210 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a23">tds_get_dynid</a>(TDSSOCKET * tds, <span class="keywordtype">char</span> **id);
01211 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a24">tds_submit_unprepare</a>(TDSSOCKET * tds, TDSDYNAMIC * dyn);
01212 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a25">tds_submit_rpc</a>(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">char</span> *rpc_name, TDSPARAMINFO * params);
01213 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a28">tds_quote_id</a>(TDSSOCKET * tds, <span class="keywordtype">char</span> *buffer, <span class="keyword">const</span> <span class="keywordtype">char</span> *id, <span class="keywordtype">int</span> idlen);
01214 <span class="keywordtype">int</span> <a class="code" href="a00307.html#a29">tds_quote_string</a>(TDSSOCKET * tds, <span class="keywordtype">char</span> *buffer, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">int</span> len);
01215 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="a00307.html#a7">tds_skip_quoted</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s);
01216 <span class="keywordtype">int</span> tds_cursor_declare(TDSSOCKET * tds, <span class="keywordtype">int</span> *send);
01217 <span class="keywordtype">int</span> tds_cursor_setrows(TDSSOCKET * tds, <span class="keywordtype">int</span> *send);
01218 <span class="keywordtype">int</span> tds_cursor_open(TDSSOCKET * tds, <span class="keywordtype">int</span> *send);
01219 <span class="keywordtype">int</span> tds_cursor_fetch(TDSSOCKET * tds);
01220 <span class="keywordtype">int</span> tds_cursor_close(TDSSOCKET * tds);
01221 <span class="keywordtype">int</span> tds_cursor_dealloc(TDSSOCKET * tds);
01222 
01223 <span class="comment">/* token.c */</span>
01224 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a32">tds_process_cancel</a>(TDSSOCKET * tds);
01225 <span class="keywordtype">void</span> tds_swap_datatype(<span class="keywordtype">int</span> coltype, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf);
01226 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a40">tds_get_token_size</a>(<span class="keywordtype">int</span> marker);
01227 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a2">tds_process_login_tokens</a>(TDSSOCKET * tds);
01228 <span class="keywordtype">void</span> <a class="code" href="a00310.html#a12">tds_add_row_column_size</a>(<a class="code" href="a00181.html">TDSRESULTINFO</a> * info, <a class="code" href="a00168.html">TDSCOLINFO</a> * curcol);
01229 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a9">tds_process_simple_query</a>(TDSSOCKET * tds);
01230 <span class="keywordtype">int</span> tds5_send_optioncmd(TDSSOCKET * tds, TDS_OPTION_CMD tds_command, TDS_OPTION tds_option, TDS_OPTION_ARG * tds_argument,
01231                         TDS_INT * tds_argsize);
01232 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a4">tds_process_result_tokens</a>(TDSSOCKET * tds, TDS_INT * result_type, <span class="keywordtype">int</span> *done_flags);
01233 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a5">tds_process_row_tokens</a>(TDSSOCKET * tds, TDS_INT * rowtype, TDS_INT * computeid);
01234 <span class="keywordtype">int</span> tds_process_row_tokens_ct(TDSSOCKET * tds, TDS_INT * rowtype, TDS_INT *computeid);
01235 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a8">tds_process_trailing_tokens</a>(TDSSOCKET * tds);
01236 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a28">tds_client_msg</a>(TDSCONTEXT * tds_ctx, TDSSOCKET * tds, <span class="keywordtype">int</span> msgnum, <span class="keywordtype">int</span> level, <span class="keywordtype">int</span> state, <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> *message);
01237 <span class="keywordtype">int</span> <a class="code" href="a00310.html#a42">tds_do_until_done</a>(TDSSOCKET * tds);
01238 
01239 <span class="comment">/* data.c */</span>
01240 <span class="keywordtype">void</span> tds_set_param_type(TDSSOCKET * tds, <a class="code" href="a00168.html">TDSCOLINFO</a> * curcol, TDS_SERVER_TYPE type);
01241 <span class="keywordtype">void</span> tds_set_column_type(<a class="code" href="a00168.html">TDSCOLINFO</a> * curcol, <span class="keywordtype">int</span> type);
01242 
01243 
01244 <span class="comment">/* tds_convert.c */</span>
01245 TDS_INT <a class="code" href="a00305.html#a43">tds_datecrack</a>(TDS_INT datetype, <span class="keyword">const</span> <span class="keywordtype">void</span> *di, <a class="code" href="a00185.html">TDSDATEREC</a> * dr);
01246 <span class="keywordtype">int</span> <a class="code" href="a00305.html#a18">tds_get_conversion_type</a>(<span class="keywordtype">int</span> srctype, <span class="keywordtype">int</span> colsize);
01247 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> tds_hex_digits[];
01248 
01249 <span class="comment">/* write.c */</span>
01250 <span class="keywordtype">int</span> tds_put_bulk_data(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, TDS_INT bufsize);
01251 <span class="keywordtype">int</span> <a class="code" href="a00308.html#a26">tds_flush_packet</a>(TDSSOCKET * tds);
01252 <span class="keywordtype">int</span> tds_put_buf(TDSSOCKET * tds, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> dsize, <span class="keywordtype">int</span> ssize);
01253 <span class="keywordtype">int</span> <a class="code" href="a00308.html#a20">tds7_put_bcpcol</a>(TDSSOCKET * tds, <span class="keyword">const</span> BCP_COLINFO * bcpcol);
01254 
01255 <span class="comment">/* read.c */</span>
01256 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tds_get_byte(TDSSOCKET * tds);
01257 <span class="keywordtype">void</span> tds_unget_byte(TDSSOCKET * tds);
01258 <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tds_peek(TDSSOCKET * tds);
01259 TDS_SMALLINT <a class="code" href="a00308.html#a4">tds_get_smallint</a>(TDSSOCKET * tds);
01260 TDS_INT <a class="code" href="a00308.html#a5">tds_get_int</a>(TDSSOCKET * tds);
01261 <span class="keywordtype">int</span> <a class="code" href="a00308.html#a6">tds_get_string</a>(TDSSOCKET * tds, <span class="keywordtype">int</span> string_len, <span class="keywordtype">char</span> *dest, size_t dest_size);
01262 <span class="keywordtype">int</span> <a class="code" href="a00308.html#a7">tds_get_char_data</a>(TDSSOCKET * tds, <span class="keywordtype">char</span> *dest, size_t wire_size, <a class="code" href="a00168.html">TDSCOLINFO</a> * curcol);
01263 <span class="keywordtype">void</span> *<a class="code" href="a00308.html#a8">tds_get_n</a>(TDSSOCKET * tds, <span class="keywordtype">void</span> *dest, <span class="keywordtype">int</span> n);
01264 <span class="keywordtype">int</span> <a class="code" href="a00308.html#a9">tds_get_size_by_type</a>(<span class="keywordtype">int</span> servertype);
01265 <span class="keywordtype">int</span> <a class="code" href="a00308.html#a10">tds_read_packet</a>(TDSSOCKET * tds);
01266 
01267 <span class="comment">/* util.c */</span>
01268 <span class="keywordtype">void</span> tds_set_parent(TDSSOCKET * tds, <span class="keywordtype">void</span> *the_parent);
01269 <span class="keywordtype">void</span> *tds_get_parent(TDSSOCKET * tds);
01270 <span class="keywordtype">void</span> tds_ctx_set_parent(TDSCONTEXT * ctx, <span class="keywordtype">void</span> *the_parent);
01271 <span class="keywordtype">void</span> *tds_ctx_get_parent(TDSCONTEXT * ctx);
01272 <span class="keywordtype">int</span> tds_swap_bytes(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> bytes);
01273 <span class="keywordtype">int</span> tds_version(TDSSOCKET * tds_socket, <span class="keywordtype">char</span> *pversion_string);
01274 <span class="keywordtype">void</span> tdsdump_off(<span class="keywordtype">void</span>);
01275 <span class="keywordtype">void</span> tdsdump_on(<span class="keywordtype">void</span>);
01276 <span class="keywordtype">int</span> tdsdump_open(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename);
01277 <span class="keywordtype">int</span> tdsdump_append(<span class="keywordtype">void</span>);
01278 <span class="keywordtype">void</span> tdsdump_close(<span class="keywordtype">void</span>);
01279 <span class="keywordtype">void</span> tdsdump_dump_buf(<span class="keyword">const</span> <span class="keywordtype">void</span> *buf, <span class="keywordtype">int</span> length);
01280 <span class="keywordtype">void</span> tdsdump_log(<span class="keywordtype">int</span> dbg_lvl, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...);
01281 <span class="keywordtype">int</span> tds_close_socket(TDSSOCKET * tds);
01282 
01283 <span class="comment">/* vstrbuild.c */</span>
01284 <span class="keywordtype">int</span> tds_vstrbuild(<span class="keywordtype">char</span> *buffer, <span class="keywordtype">int</span> buflen, <span class="keywordtype">int</span> *resultlen, <span class="keywordtype">char</span> *text, <span class="keywordtype">int</span> textlen, <span class="keyword">const</span> <span class="keywordtype">char</span> *formats, <span class="keywordtype">int</span> formatlen,
01285                   va_list ap);
01286 
01287 <span class="comment">/* numeric.c */</span>
01288 <span class="keywordtype">char</span> *tds_money_to_string(<span class="keyword">const</span> TDS_MONEY * money, <span class="keywordtype">char</span> *s);
01289 <span class="keywordtype">char</span> *tds_numeric_to_string(<span class="keyword">const</span> TDS_NUMERIC * numeric, <span class="keywordtype">char</span> *s);
01290 
01291 <span class="comment">/* getmac.c */</span>
01292 <span class="keywordtype">void</span> tds_getmac(<span class="keywordtype">int</span> s, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> mac[6]);
01293 
01294 <span class="keyword">typedef</span> <span class="keyword">struct </span>tds_answer
01295 {
01296         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> lm_resp[24];
01297         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> nt_resp[24];
01298 } TDSANSWER;
01299 <span class="keywordtype">void</span> <a class="code" href="a00303.html#a2">tds_answer_challenge</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *passwd, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *challenge, TDSANSWER * answer);
01300 
01301 <span class="preprocessor">#define IS_TDS42(x) (x-&gt;major_version==4 &amp;&amp; x-&gt;minor_version==2)</span>
01302 <span class="preprocessor"></span><span class="preprocessor">#define IS_TDS46(x) (x-&gt;major_version==4 &amp;&amp; x-&gt;minor_version==6)</span>
01303 <span class="preprocessor"></span><span class="preprocessor">#define IS_TDS50(x) (x-&gt;major_version==5 &amp;&amp; x-&gt;minor_version==0)</span>
01304 <span class="preprocessor"></span><span class="preprocessor">#define IS_TDS70(x) (x-&gt;major_version==7 &amp;&amp; x-&gt;minor_version==0)</span>
01305 <span class="preprocessor"></span><span class="preprocessor">#define IS_TDS80(x) (x-&gt;major_version==8 &amp;&amp; x-&gt;minor_version==0)</span>
01306 <span class="preprocessor"></span>
01307 <span class="preprocessor">#define IS_TDS7_PLUS(x) ( IS_TDS70(x) || IS_TDS80(x) )</span>
01308 <span class="preprocessor"></span>
01309 <span class="preprocessor">#define IS_TDSDEAD(x) (((x) == NULL) || TDS_IS_SOCKET_INVALID((x)-&gt;s))</span>
01310 <span class="preprocessor"></span>
<a name="l01312"></a><a class="code" href="a00273.html#a227">01312</a> <span class="preprocessor">#define TDS_IS_SYBASE(x) (!(x-&gt;product_version &amp; 0x80000000u))</span>
01313 <span class="preprocessor"></span>
<a name="l01314"></a><a class="code" href="a00273.html#a228">01314</a> <span class="preprocessor">#define TDS_IS_MSSQL(x) ((x-&gt;product_version &amp; 0x80000000u)!=0)</span>
01315 <span class="preprocessor"></span>
<a name="l01319"></a><a class="code" href="a00273.html#a229">01319</a> <span class="preprocessor">#define TDS_MS_VER(maj,min,x) (0x80000000u|((maj)&lt;&lt;24)|((min)&lt;&lt;16)|(x))</span>
01320 <span class="preprocessor"></span>
01321 <span class="comment">/* TODO test if not similar to ms one*/</span>
<a name="l01323"></a><a class="code" href="a00273.html#a230">01323</a> <span class="preprocessor">#define TDS_SYB_VER(maj,min,x) (((maj)&lt;&lt;24)|((min)&lt;&lt;16)|(x)&lt;&lt;8)</span>
01324 <span class="preprocessor"></span>
01325 <span class="preprocessor">#ifdef __cplusplus</span>
01326 <span class="preprocessor"></span><span class="preprocessor">#if 0</span>
01327 <span class="preprocessor"></span>{
01328 <span class="preprocessor">#endif</span>
01329 <span class="preprocessor"></span>}
01330 <span class="preprocessor">#endif</span>
01331 <span class="preprocessor"></span>
01332 <span class="preprocessor">#endif </span><span class="comment">/* _tds_h_ */</span>
</pre></div><hr><address style="align: right;"><small>Generated on Sun Jun 13 18:55:26 2004 for FreeTDS API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3 </small></address>
</body>
</html>
