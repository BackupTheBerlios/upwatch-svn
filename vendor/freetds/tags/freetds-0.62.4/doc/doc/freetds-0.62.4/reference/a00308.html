<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Network functions</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>Network functions<br>
<small>
[<a class="el" href="a00311.html">LibTDS API</a>]</small>
</h1>Functions for reading or writing from network. 
<a href="#_details">More...</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td nowrap align=right valign=top><a name="a27" doxytag="network::TEMP_INIT"></a>
#define&nbsp;</td><td valign=bottom><b>TEMP_INIT</b>(s)&nbsp;&nbsp;&nbsp;char temp[s]</td></tr>
<tr><td nowrap align=right valign=top><a name="a28" doxytag="network::TEMP_FREE"></a>
#define&nbsp;</td><td valign=bottom><b>TEMP_FREE</b>&nbsp;&nbsp;&nbsp;;</td></tr>
<tr><td nowrap align=right valign=top><a name="a29" doxytag="network::TEMP_SIZE"></a>
#define&nbsp;</td><td valign=bottom><b>TEMP_SIZE</b>&nbsp;&nbsp;&nbsp;sizeof(temp)</td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top><a name="a1" doxytag="network::tds_get_byte"></a>
unsigned char&nbsp;</td><td valign=bottom><b>tds_get_byte</b> (TDSSOCKET *tds)</td></tr>
<tr><td nowrap align=right valign=top><a name="a2" doxytag="network::tds_unget_byte"></a>
void&nbsp;</td><td valign=bottom><b>tds_unget_byte</b> (TDSSOCKET *tds)</td></tr>
<tr><td nowrap align=right valign=top><a name="a3" doxytag="network::tds_peek"></a>
unsigned char&nbsp;</td><td valign=bottom><b>tds_peek</b> (TDSSOCKET *tds)</td></tr>
<tr><td nowrap align=right valign=top><a name="a4" doxytag="network::tds_get_smallint"></a>
TDS_SMALLINT&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a4">tds_get_smallint</a> (TDSSOCKET *tds)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Get an int16 from the server.</em><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a5" doxytag="network::tds_get_int"></a>
TDS_INT&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a5">tds_get_int</a> (TDSSOCKET *tds)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Get an int32 from the server.</em><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a6">tds_get_string</a> (TDSSOCKET *tds, int string_len, char *dest, size_t dest_size)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Fetch a string from the wire.</em> <a href="#a6"></a><em></em><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a7">tds_get_char_data</a> (TDSSOCKET *tds, char *row_buffer, size_t wire_size, <a class="el" href="a00168.html">TDSCOLINFO</a> *curcol)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Fetch character data the wire.</em> <a href="#a7"></a><em></em><br><br></td></tr>
<tr><td nowrap align=right valign=top>void *&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a8">tds_get_n</a> (TDSSOCKET *tds, void *dest, int need)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Get N bytes from the buffer and return them in the already allocated space given to us.</em> <a href="#a8"></a><em></em><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a9" doxytag="network::tds_get_size_by_type"></a>
int&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a9">tds_get_size_by_type</a> (int servertype)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Return the number of bytes needed by specified type.</em><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a10">tds_read_packet</a> (TDSSOCKET *tds)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Read in one 'packet' from the server.</em> <a href="#a10"></a><em></em><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a12" doxytag="network::tds_put_n"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_n</b> (TDSSOCKET *tds, const void *buf, int n)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a13">tds_put_string</a> (TDSSOCKET *tds, const char *s, int len)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Output a string to wire automatic translate string to unicode if needed.</em> <a href="#a13"></a><em></em><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a14" doxytag="network::tds_put_buf"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_buf</b> (TDSSOCKET *tds, const unsigned char *buf, int dsize, int ssize)</td></tr>
<tr><td nowrap align=right valign=top><a name="a15" doxytag="network::tds_put_int8"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_int8</b> (TDSSOCKET *tds, TDS_INT8 i)</td></tr>
<tr><td nowrap align=right valign=top><a name="a16" doxytag="network::tds_put_int"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_int</b> (TDSSOCKET *tds, TDS_INT i)</td></tr>
<tr><td nowrap align=right valign=top><a name="a17" doxytag="network::tds_put_smallint"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_smallint</b> (TDSSOCKET *tds, TDS_SMALLINT si)</td></tr>
<tr><td nowrap align=right valign=top><a name="a18" doxytag="network::tds_put_tinyint"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_tinyint</b> (TDSSOCKET *tds, TDS_TINYINT ti)</td></tr>
<tr><td nowrap align=right valign=top><a name="a19" doxytag="network::tds_put_byte"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_byte</b> (TDSSOCKET *tds, unsigned char c)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a20">tds7_put_bcpcol</a> (TDSSOCKET *tds, const BCP_COLINFO *bcpcol)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Write a column's data to the TDS bcp stream.</em> <a href="#a20"></a><em></em><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a21" doxytag="network::tds_put_bulk_data"></a>
int&nbsp;</td><td valign=bottom><b>tds_put_bulk_data</b> (TDSSOCKET *tds, const unsigned char *buf, TDS_INT bufsize)</td></tr>
<tr><td nowrap align=right valign=top><a name="a22" doxytag="network::tds_init_write_buf"></a>
int&nbsp;</td><td valign=bottom><b>tds_init_write_buf</b> (TDSSOCKET *tds)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="a00308.html#a26">tds_flush_packet</a> (TDSSOCKET *tds)</td></tr>
<tr><td>&nbsp;</td><td><em class="mdesc">Flush packet to server.</em> <a href="#a26"></a><em></em><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Functions for reading or writing from network.
<p>
<hr><h2>Function Documentation</h2>
<a name="a20" doxytag="write.c::tds7_put_bcpcol"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int tds7_put_bcpcol </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TDSSOCKET *&nbsp;</td>
          <td class="mdname" nowrap> <em>tds</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const BCP_COLINFO *&nbsp;</td>
          <td class="mdname" nowrap> <em>bcpcol</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write a column's data to the TDS bcp stream.
<p>
Data may be null. <dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>TDS_SUCCEED</em>&nbsp;</td><td>data written </td></tr>
    <tr><td valign=top><em>TDS_FAIL</em>&nbsp;</td><td>must not write null data non-null column </td></tr>
  </table>
</dl>
<dl compact><dt><b>Remarks:</b></dt><dd>Most other write functions simply return zero. </dd></dl>
    </td>
  </tr>
</table>
<a name="a26" doxytag="write.c::tds_flush_packet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int tds_flush_packet </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TDSSOCKET *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>tds</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Flush packet to server.
<p>
<dl compact><dt><b>Returns:</b></dt><dd>TDS_FAIL or TDS_SUCCEED </dd></dl>
    </td>
  </tr>
</table>
<a name="a7" doxytag="read.c::tds_get_char_data"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int tds_get_char_data </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TDSSOCKET *&nbsp;</td>
          <td class="mdname" nowrap> <em>tds</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>row_buffer</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>wire_size</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="a00168.html">TDSCOLINFO</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>curcol</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fetch character data the wire.
<p>
Output is NOT null terminated. If <em>iconv_info</em> is not NULL, convert data accordingly. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>row_buffer</em>&nbsp;</td><td>destination buffer in current_row. Can't be NULL </td></tr>
    <tr><td valign=top><em>wire_size</em>&nbsp;</td><td>size to read from wire (in bytes) </td></tr>
    <tr><td valign=top><em>curcol</em>&nbsp;</td><td>column information </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>TDS_SUCCEED or TDS_FAIL (probably memory error on text data) </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000045">Todo:</a></b></dt><dd>put a TDSICONVINFO structure in every TDSCOLINFO </dd></dl>
    </td>
  </tr>
</table>
<a name="a8" doxytag="read.c::tds_get_n"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* tds_get_n </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TDSSOCKET *&nbsp;</td>
          <td class="mdname" nowrap> <em>tds</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>need</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get N bytes from the buffer and return them in the already allocated space given to us.
<p>
We ASSUME that the person calling this function has done the bounds checking for us since they know how many bytes they want here. dest of NULL means we just want to eat the bytes. (<a href="mailto:tetherow@nol.org">tetherow@nol.org</a>)     </td>
  </tr>
</table>
<a name="a6" doxytag="read.c::tds_get_string"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int tds_get_string </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TDSSOCKET *&nbsp;</td>
          <td class="mdname" nowrap> <em>tds</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>string_len</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>dest</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>dest_size</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fetch a string from the wire.
<p>
Output string is NOT null terminated. If TDS version is 7 or 8 read unicode string and convert it. This function should be use to read server default encoding strings like columns name, table names, etc, not for data (use tds_get_char_data instead) <dl compact><dt><b>Returns:</b></dt><dd>bytes written to <em>dest</em> </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>tds</em>&nbsp;</td><td>connection information </td></tr>
    <tr><td valign=top><em>string_len</em>&nbsp;</td><td>length of string to read from wire (in server characters, bytes for tds4-tds5, ucs2 for tds7+) </td></tr>
    <tr><td valign=top><em>dest</em>&nbsp;</td><td>destination buffer, if NULL string is read and discarded </td></tr>
    <tr><td valign=top><em>dest_size</em>&nbsp;</td><td>destination buffer size, in bytes </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a13" doxytag="write.c::tds_put_string"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int tds_put_string </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TDSSOCKET *&nbsp;</td>
          <td class="mdname" nowrap> <em>tds</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>s</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Output a string to wire automatic translate string to unicode if needed.
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>s</em>&nbsp;</td><td>string to write </td></tr>
    <tr><td valign=top><em>len</em>&nbsp;</td><td>length of string in characters, or -1 for null terminated </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a10" doxytag="read.c::tds_read_packet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int tds_read_packet </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TDSSOCKET *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>tds</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read in one 'packet' from the server.
<p>
This is a wrapped outer packet of the protocol (they bundle result packets into chunks and wrap them at what appears to be 512 bytes regardless of how that breaks internal packet up. (tetherow@nol.org) <dl compact><dt><b>Returns:</b></dt><dd>bytes read or -1 on failure </dd></dl>
    </td>
  </tr>
</table>
<hr><address style="align: right;"><small>Generated on Sun Jun 13 18:55:28 2004 for FreeTDS API by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3 </small></address>
</body>
</html>
